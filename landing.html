<html>
  <head>
    <title>Welcome to Our Service</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://unpkg.com/typescript@4"></script>
    <link rel="stylesheet" href="./assets/css/PPTEditor.css" />
    <link rel="stylesheet" href="./assets/css/PPTModal.css" />
    <link rel="stylesheet" href="./assets/css/SlideSettingsModal.css" />
    <link rel="stylesheet" href="./assets/css/ThemeColorPicker.css" />
    <link rel="stylesheet" href="./assets/css/ThemeFontsEditor.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/lucide-static@latest/font/lucide.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/typescript/4.5.4/typescript.min.js"></script>
    <script src="./assets/ts/script.ts"></script>
  </head>
  <body>
    <div
      class="container d-flex flex-column justify-content-center align-items-center"
    >
      <div class="row align-items-center justify-content-center">
        <div class="text-center">
          <button
            class="btn btn-primary btn-lg d-inline-flex align-items-center gap-2"
            data-bs-toggle="modal"
            data-bs-target="#staticBackdrop"
          >
            <i
              class="icon-presentation"
              style="
                font-size: 24px;
                height: 1em;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                vertical-align: middle;
              "
            ></i>
            Open settings
          </button>
        </div>
      </div>
      <div
        class="modal fade rounded-5 ppt-editor-modal"
        id="staticBackdrop"
        data-bs-backdrop="static"
        data-bs-keyboard="false"
        tabindex="-1"
        aria-labelledby="staticBackdropLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-xl modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header border-0 px-4 pt-4 pb-0">
              <div
                class="d-flex justify-content-between align-items-center w-100"
              >
                <div class="d-flex align-items-center gap-2">
                  <i
                    class="icon-settings text-primary"
                    style="font-size: 24px"
                  ></i>
                  <h5 class="modal-title mb-0 h4">Presentation Settings</h5>
                </div>
                <button
                  type="button"
                  class="btn-close-custom"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                >
                  <i class="icon-x" style="font-size: 24px"></i>
                </button>
              </div>
            </div>
            <div class="modal-body px-4 py-3">
              <div class="settings-container">
                <div class="position-relative editor-container">
                  <div class="ppt-editor">
                    <div class="editor-toolbar">
                      <div class="toolbar-section">
                        <button class="toolbar-btn" disabled="">
                          <i
                            class="icon-chevron-left"
                            style="font-size: 20px"
                          ></i>
                        </button>
                        <span class="slide-counter">1 / 1</span>
                        <button class="toolbar-btn" disabled="">
                          <i
                            class="icon-chevron-right"
                            style="font-size: 20px"
                          ></i>
                        </button>
                      </div>
                      <div class="toolbar-section">
                        <button class="toolbar-btn success">
                          <i class="icon-save" style="font-size: 20px"></i>
                          <span><strong>Save</strong></span>
                        </button>
                      </div>
                      <div class="toolbar-section">
                        <button
                          class="toolbar-btn add-dropdown-menu"
                          id="toggleSettingsBtn"
                        >
                          <i class="icon-settings" style="font-size: 20px"></i>
                          <span><strong>Settings</strong></span>
                        </button>
                        <button class="toolbar-btn" id="themePickerBtn">
                          <i class="icon-palette" style="font-size: 20px"></i>
                          <span><strong>Theme</strong></span>
                        </button>
                        <div class="theme-fonts-dropdown position-relative">
                          <button
                            class="btn btn-primary d-flex align-items-center gap-1"
                          >
                            <i class="icon-plus" style="font-size: 16px"></i>
                            Create New Theme Fonts
                            <i
                              class="icon-chevron-down"
                              style="font-size: 16px"
                            ></i>
                          </button>
                          <div
                            class="dropdown-menu show position-absolute"
                            style="display: none"
                            style="min-width: 300px"
                          >
                            <button
                              class="dropdown-item d-flex align-items-center gap-2"
                              id="dropdown-fonts-edit-overlay"
                            >
                              <i class="icon-plus" style="font-size: 16px"></i>
                              Custom Theme Selection
                            </button>
                          </div>
                          <div
                            class="fonts-editor-overlay"
                            style="display: none"
                          >
                            <div class="fonts-editor-container m-auto">
                              <div class="fonts-editor-content">
                                <div class="fonts-editor-header pt-0">
                                  <div class="header-content">
                                    <i
                                      class="icon-type header-icon text-primary"
                                      style="font-size: 24px"
                                    ></i>
                                    <div>
                                      <h4>Theme Fonts Editor</h4>
                                      <p>
                                        Customize your presentation's typography
                                      </p>
                                    </div>
                                  </div>
                                  <button class="close-button">
                                    <i
                                      class="icon-x"
                                      style="font-size: 16px"
                                    ></i>
                                  </button>
                                </div>
                                <form>
                                  <div class="fonts-editor-body">
                                    <div class="theme-name-section">
                                      <label for="themeName">Theme Name</label
                                      ><input
                                        id="themeName"
                                        placeholder="Enter theme name"
                                        type="text"
                                        value=""
                                      />
                                    </div>
                                    <div class="fonts-section">
                                      <div class="font-group">
                                        <label for="titleFont"
                                          >Heading Font</label
                                        ><select id="titleFont">
                                          <option value="Arial">
                                            Arial (Sans-serif)
                                          </option>
                                          <option value="Calibri">
                                            Calibri (Sans-serif)
                                          </option>
                                          <option value="Times New Roman">
                                            Times New Roman (Serif)
                                          </option>
                                          <option value="Helvetica">
                                            Helvetica (Sans-serif)
                                          </option>
                                          <option value="Georgia">
                                            Georgia (Serif)
                                          </option>
                                          <option value="Verdana">
                                            Verdana (Sans-serif)
                                          </option>
                                          <option value="Tahoma">
                                            Tahoma (Sans-serif)
                                          </option>
                                          <option value="Trebuchet MS">
                                            Trebuchet MS (Sans-serif)
                                          </option>
                                          <option value="Century Gothic">
                                            Century Gothic (Sans-serif)
                                          </option>
                                          <option value="Garamond">
                                            Garamond (Serif)
                                          </option>
                                        </select>
                                        <div class="font-preview">
                                          <div class="font-info">
                                            <div class="font-name">Arial</div>
                                            <div class="font-category">
                                              Sans-serif
                                            </div>
                                          </div>
                                          <div
                                            class="preview-text"
                                            style="
                                              font-family: Arial;
                                              font-size: 24px;
                                            "
                                          >
                                            Main Heading Sample
                                          </div>
                                        </div>
                                      </div>
                                      <div class="font-group">
                                        <label for="bodyFont">Body Font</label
                                        ><select id="bodyFont">
                                          <option value="Arial">
                                            Arial (Sans-serif)
                                          </option>
                                          <option value="Calibri">
                                            Calibri (Sans-serif)
                                          </option>
                                          <option value="Times New Roman">
                                            Times New Roman (Serif)
                                          </option>
                                          <option value="Helvetica">
                                            Helvetica (Sans-serif)
                                          </option>
                                          <option value="Georgia">
                                            Georgia (Serif)
                                          </option>
                                          <option value="Verdana">
                                            Verdana (Sans-serif)
                                          </option>
                                          <option value="Tahoma">
                                            Tahoma (Sans-serif)
                                          </option>
                                          <option value="Trebuchet MS">
                                            Trebuchet MS (Sans-serif)
                                          </option>
                                          <option value="Century Gothic">
                                            Century Gothic (Sans-serif)
                                          </option>
                                          <option value="Garamond">
                                            Garamond (Serif)
                                          </option>
                                        </select>
                                        <div class="font-preview">
                                          <div class="font-info">
                                            <div class="font-name">Calibri</div>
                                            <div class="font-category">
                                              Sans-serif
                                            </div>
                                          </div>
                                          <div
                                            class="preview-text"
                                            style="
                                              font-family: Calibri;
                                              font-size: 16px;
                                            "
                                          >
                                            Lorem ipsum dolor sit amet,
                                            consectetur adipiscing elit. Sed do
                                            eiusmod tempor incididunt ut labore.
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="fonts-editor-footer pt-0">
                                    <button
                                      type="button"
                                      class="btn btn-cancel"
                                    >
                                      Cancel</button
                                    ><button
                                      type="submit"
                                      class="btn btn-save save-fonts"
                                    >
                                      <i
                                        class="icon-save"
                                        style="font-size: 24px"
                                      ></i>
                                      Save Theme Fonts
                                    </button>
                                  </div>
                                </form>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div
                      class="settings-panel"
                      id="settingsPanel"
                      style="display: none"
                    >
                      <div class="settings-content">
                        <div class="settings-section">
                          <h6>Presentation Theme</h6>
                          <div class="theme-grid">
                            <button
                              class="theme-btn active"
                              style="
                                background-color: rgb(255, 255, 255);
                                color: rgb(0, 0, 0);
                              "
                            >
                              <div class="theme-preview">
                                <div
                                  class="theme-title"
                                  style="color: rgb(0, 0, 0)"
                                >
                                  Default
                                </div>
                                <div
                                  class="theme-content"
                                  style="color: rgb(51, 51, 51)"
                                >
                                  Sample Text
                                </div>
                              </div>
                            </button>
                            <button
                              class="theme-btn"
                              style="
                                background-color: rgb(44, 62, 80);
                                color: rgb(255, 255, 255);
                              "
                            >
                              <div class="theme-preview">
                                <div
                                  class="theme-title"
                                  style="color: rgb(255, 255, 255)"
                                >
                                  Dark
                                </div>
                                <div
                                  class="theme-content"
                                  style="color: rgb(236, 240, 241)"
                                >
                                  Sample Text
                                </div>
                              </div>
                            </button>
                            <button
                              class="theme-btn"
                              style="
                                background-color: rgb(248, 249, 250);
                                color: rgb(44, 62, 80);
                              "
                            >
                              <div class="theme-preview">
                                <div
                                  class="theme-title"
                                  style="color: rgb(44, 62, 80)"
                                >
                                  Professional
                                </div>
                                <div
                                  class="theme-content"
                                  style="color: rgb(52, 73, 94)"
                                >
                                  Sample Text
                                </div>
                              </div></button
                            ><button
                              class="theme-btn"
                              style="
                                background-color: rgb(240, 243, 244);
                                color: rgb(231, 76, 60);
                              "
                            >
                              <div class="theme-preview">
                                <div
                                  class="theme-title"
                                  style="color: rgb(231, 76, 60)"
                                >
                                  Creative
                                </div>
                                <div
                                  class="theme-content"
                                  style="color: rgb(44, 62, 80)"
                                >
                                  Sample Text
                                </div>
                              </div>
                            </button>
                          </div>
                        </div>
                        <div class="settings-section">
                          <h6>Background Color</h6>
                          <div class="color-picker">
                            <input type="color" value="#ffffff" />
                            <span>#FFFFFF</span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="editor-content">
                      <div class="slides-sidebar">
                        <div class="new-slide-thumbnail">
                          <div
                            class="thumbnail-preview"
                            style="
                              background-color: rgb(255, 255, 255);
                              display: flex;
                              align-items: center;
                              justify-content: center;
                            "
                          >
                            <div class="new-slide-content">
                              <i
                                class="icon-plus"
                                style="
                                  font-size: 16px;
                                  color: black;
                                  height: 1em;
                                "
                              ></i>
                              <span
                                class="thumbnail-title"
                                style="color: rgb(0, 0, 0)"
                              >
                                Create New
                              </span>
                            </div>
                          </div>
                        </div>
                        <div class="slide-thumbnail active">
                          <div
                            class="thumbnail-preview"
                            style="
                              background-color: rgb(255, 255, 255);
                              cursor: pointer;
                            "
                          >
                            <div
                              class="thumbnail-content"
                              data-editing="false"
                              style="color: rgb(0, 0, 0)"
                            >
                              <div class="thumbnail-title">
                                Sales Performance
                              </div>
                              <div
                                class="thumbnail-text"
                                style="color: rgb(51, 51, 51)"
                              >
                                This chart shows quarterly sales pe...
                              </div>
                            </div>
                          </div>
                          <div class="thumbnail-footer">
                            <div class="thumbnail-number">Theme 1</div>
                            <button
                              class="edit-button"
                              data-bs-toggle="modal"
                              data-bs-target="#settingModal"
                            >
                              <i class="icon-pen" style="font-size: 16px"></i>
                            </button>
                          </div>
                        </div>
                      </div>
                      <div class="slide-editor">
                        <div class="slide-container">
                          <div
                            class="slide-content mb-4"
                            style="
                              background-color: rgb(255, 255, 255);
                              position: relative;
                            "
                          >
                            <input
                              class="slide-title"
                              placeholder="Click to add title"
                              readonly=""
                              type="text"
                              value="Sales Performance"
                              style="color: rgb(0, 0, 0); font-family: Arial"
                            />
                            <textarea
                              class="slide-body"
                              placeholder="Click to add content"
                              readonly=""
                              style="
                                color: rgb(51, 51, 51);
                                font-family: Calibri;
                                min-height: 80px;
                                height: auto;
                                overflow: auto;
                                resize: vertical;
                              "
                            >
This chart shows quarterly sales performance comparison.
                            </textarea>
                            <div
                              class="chart-container"
                              style="width: 100%; height: 75%"
                            >
                              <div class="chart-editor preview-mode card mb-3">
                                <div class="card-body">
                                  <div
                                    class="d-flex justify-content-between align-items-center mb-3"
                                  >
                                    <h5
                                      class="card-title mb-0"
                                      style="
                                        color: rgb(68, 84, 106);
                                        transition: color 0.3s;
                                      "
                                    >
                                      Sales Performance
                                    </h5>
                                  </div>
                                  <canvas
                                    id="bar-chart"
                                    width="300"
                                    height="250"
                                  ></canvas>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div
                            class="slide-content mb-4"
                            style="
                              background-color: rgb(255, 255, 255);
                              position: relative;
                            "
                          >
                            <input
                              class="slide-title"
                              placeholder="Click to add title"
                              readonly=""
                              type="text"
                              value="Monthly Trends"
                              style="color: rgb(0, 0, 0); font-family: Arial"
                            />
                            <textarea
                              class="slide-body"
                              placeholder="Click to add content"
                              readonly=""
                              style="
                                color: rgb(51, 51, 51);
                                font-family: Calibri;
                                min-height: 80px;
                                height: auto;
                                overflow: auto;
                                resize: vertical;
                              "
                            >
Visualizing the monthly growth trends across different series.
                            </textarea>
                            <div
                              class="chart-container"
                              style="width: 100%; height: 75%"
                            >
                              <div class="chart-editor preview-mode card mb-3">
                                <div class="card-body">
                                  <div
                                    class="d-flex justify-content-between align-items-center mb-3"
                                  >
                                    <h5
                                      class="card-title mb-0"
                                      style="
                                        color: rgb(68, 84, 106);
                                        transition: color 0.3s;
                                      "
                                    >
                                      Monthly Trends
                                    </h5>
                                  </div>
                                  <canvas
                                    id="line-chart"
                                    width="370"
                                    height="300"
                                  ></canvas>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div
                            class="slide-content mb-4"
                            style="
                              background-color: rgb(255, 255, 255);
                              position: relative;
                            "
                          >
                            <input
                              class="slide-title"
                              placeholder="Click to add title"
                              readonly=""
                              type="text"
                              value="Market Distribution"
                              style="color: rgb(0, 0, 0); font-family: Arial"
                            />
                            <textarea
                              class="slide-body"
                              placeholder="Click to add content"
                              readonly=""
                              style="
                                color: rgb(51, 51, 51);
                                font-family: Calibri;
                                min-height: 80px;
                                height: auto;
                                overflow: auto;
                                resize: vertical;
                              "
                            >
Breakdown of market share across different products.
                            </textarea>
                            <div
                              class="chart-container"
                              style="width: 100%; height: 75%"
                            >
                              <div class="chart-editor preview-mode card mb-3">
                                <div class="card-body">
                                  <div
                                    class="d-flex justify-content-between align-items-center mb-3"
                                  >
                                    <h5
                                      class="card-title mb-0"
                                      style="
                                        color: rgb(68, 84, 106);
                                        transition: color 0.3s;
                                      "
                                    >
                                      Market Describution
                                    </h5>
                                  </div>
                                  <canvas
                                    id="pie-chart"
                                    width="370"
                                    height="300"
                                  ></canvas>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div
                      class="theme-picker-overlay"
                      style="display: none"
                      id="themePickerOverlay"
                    >
                      <div class="theme-picker-container" style="margin: auto">
                        <div class="theme-picker-content">
                          <div
                            class="theme-picker-header"
                            style="padding-top: 0"
                          >
                            <div class="header-content">
                              <i
                                class="icon-paintbrush header-icon text-primary"
                                style="font-size: 24px"
                              ></i>

                              <div>
                                <h4>Theme Color Editor</h4>
                                <p>
                                  Customize your presentation's color scheme
                                </p>
                              </div>
                            </div>
                            <button class="close-button">
                              <i class="icon-x" style="font-size: 24px"></i>
                            </button>
                          </div>
                          <div class="theme-picker-body">
                            <div class="row g-4">
                              <div class="col-md-7">
                                <div class="color-sections">
                                  <div class="section-tabs">
                                    <button class="section-tab active">
                                      Text Colors</button
                                    ><button class="section-tab">
                                      Accent Colors</button
                                    ><button class="section-tab">
                                      Links Colors
                                    </button>
                                  </div>
                                  <div class="color-inputs" id="text-colors">
                                    <div class="color-input-group">
                                      <label class="color-label"
                                        >Text Dark1</label
                                      >
                                      <div class="color-input-wrapper">
                                        <input
                                          class="color-input"
                                          type="color"
                                          value="#44546A"
                                        /><input
                                          class="color-text-input"
                                          type="text"
                                          value="#44546A"
                                        />
                                      </div>
                                    </div>
                                    <div class="color-input-group">
                                      <label class="color-label"
                                        >Text Light1</label
                                      >
                                      <div class="color-input-wrapper">
                                        <input
                                          class="color-input"
                                          type="color"
                                          value="#FFFFFF"
                                        /><input
                                          class="color-text-input"
                                          type="text"
                                          value="#FFFFFF"
                                        />
                                      </div>
                                    </div>
                                    <div class="color-input-group">
                                      <label class="color-label"
                                        >Text Dark2</label
                                      >
                                      <div class="color-input-wrapper">
                                        <input
                                          class="color-input"
                                          type="color"
                                          value="#44546A"
                                        /><input
                                          class="color-text-input"
                                          type="text"
                                          value="#44546A"
                                        />
                                      </div>
                                    </div>
                                    <div class="color-input-group">
                                      <label class="color-label"
                                        >Text Light2</label
                                      >
                                      <div class="color-input-wrapper">
                                        <input
                                          class="color-input"
                                          type="color"
                                          value="#E7E6E6"
                                        /><input
                                          class="color-text-input"
                                          type="text"
                                          value="#E7E6E6"
                                        />
                                      </div>
                                    </div>
                                  </div>
                                  <div
                                    class="color-inputs"
                                    style="display: none"
                                    id="account-colors"
                                  >
                                    <div class="color-input-group">
                                      <label class="color-label">Accent1</label>
                                      <div class="color-input-wrapper">
                                        <input
                                          class="color-input"
                                          type="color"
                                          value="#4472C4"
                                        /><input
                                          class="color-text-input"
                                          type="text"
                                          value="#4472C4"
                                        />
                                      </div>
                                    </div>
                                    <div class="color-input-group">
                                      <label class="color-label">Accent2</label>
                                      <div class="color-input-wrapper">
                                        <input
                                          class="color-input"
                                          type="color"
                                          value="#ED7D31"
                                        /><input
                                          class="color-text-input"
                                          type="text"
                                          value="#ED7D31"
                                        />
                                      </div>
                                    </div>
                                    <div class="color-input-group">
                                      <label class="color-label">Accent3</label>
                                      <div class="color-input-wrapper">
                                        <input
                                          class="color-input"
                                          type="color"
                                          value="#A5A5A5"
                                        /><input
                                          class="color-text-input"
                                          type="text"
                                          value="#A5A5A5"
                                        />
                                      </div>
                                    </div>
                                    <div class="color-input-group">
                                      <label class="color-label">Accent4</label>
                                      <div class="color-input-wrapper">
                                        <input
                                          class="color-input"
                                          type="color"
                                          value="#FFC000"
                                        /><input
                                          class="color-text-input"
                                          type="text"
                                          value="#FFC000"
                                        />
                                      </div>
                                    </div>
                                    <div class="color-input-group">
                                      <label class="color-label">Accent5</label>
                                      <div class="color-input-wrapper">
                                        <input
                                          class="color-input"
                                          type="color"
                                          value="#5B9BD5"
                                        /><input
                                          class="color-text-input"
                                          type="text"
                                          value="#5B9BD5"
                                        />
                                      </div>
                                    </div>
                                    <div class="color-input-group">
                                      <label class="color-label">Accent6</label>
                                      <div class="color-input-wrapper">
                                        <input
                                          class="color-input"
                                          type="color"
                                          value="#70AD47"
                                        /><input
                                          class="color-text-input"
                                          type="text"
                                          value="#70AD47"
                                        />
                                      </div>
                                    </div>
                                  </div>
                                  <div
                                    class="color-inputs"
                                    style="display: none"
                                    id="links-colors"
                                  >
                                    <div class="color-input-group">
                                      <label class="color-label"
                                        >Hyperlink</label
                                      >
                                      <div class="color-input-wrapper">
                                        <input
                                          class="color-input"
                                          type="color"
                                          value="#0563C1"
                                        /><input
                                          class="color-text-input"
                                          type="text"
                                          value="#0563C1"
                                        />
                                      </div>
                                    </div>
                                    <div class="color-input-group">
                                      <label class="color-label"
                                        >Followed Hyperlink</label
                                      >
                                      <div class="color-input-wrapper">
                                        <input
                                          class="color-input"
                                          type="color"
                                          value="#954F72"
                                        /><input
                                          class="color-text-input"
                                          type="text"
                                          value="#954F72"
                                        />
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="theme-name-input">
                                  <label>Theme Name</label
                                  ><input
                                    placeholder="Enter theme name"
                                    class="form-control"
                                    type="text"
                                    value="Custom 1"
                                  />
                                </div>
                              </div>
                              <div class="col-md-5">
                                <div class="preview-section">
                                  <h6>Preview</h6>
                                  <div class="preview-container">
                                    <div class="preview-item">
                                      <label>Dark Theme</label>
                                      <div
                                        class="p-3"
                                        style="
                                          background-color: rgb(68, 84, 106);
                                          color: rgb(255, 255, 255);
                                          height: 200px;
                                          border-radius: 4px;
                                        "
                                      >
                                        <div class="mb-2">Text</div>
                                        <div style="height: 100px">
                                          <div
                                            class="recharts-responsive-container"
                                            style="
                                              width: 100%;
                                              height: 100%;
                                              min-width: 0px;
                                            "
                                          >
                                            <div
                                              class="recharts-wrapper"
                                              style="
                                                position: relative;
                                                cursor: default;
                                                width: 100%;
                                                height: 100%;
                                                max-height: 100px;
                                                max-width: 344px;
                                              "
                                            >
                                              <canvas
                                                id="example-chart"
                                                width="370"
                                                height="100"
                                                style="
                                                  width: 100%;
                                                  height: 300px;
                                                "
                                              ></canvas>
                                            </div>
                                          </div>
                                        </div>
                                        <div style="color: rgb(5, 99, 193)">
                                          Hyperlink
                                        </div>
                                        <div style="color: rgb(149, 79, 114)">
                                          Hyperlink
                                        </div>
                                      </div>
                                    </div>
                                    <div class="preview-item">
                                      <label>Light Theme</label>
                                      <div
                                        class="p-3"
                                        style="
                                          background-color: rgb(255, 255, 255);
                                          color: rgb(68, 84, 106);
                                          height: 200px;
                                          border-radius: 4px;
                                        "
                                      >
                                        <div class="mb-2">Text</div>
                                        <div style="height: 100px">
                                          <div
                                            class="recharts-responsive-container"
                                            style="
                                              width: 100%;
                                              height: 100%;
                                              min-width: 0px;
                                            "
                                          >
                                            <div
                                              class="recharts-wrapper"
                                              style="
                                                position: relative;
                                                cursor: default;
                                                width: 100%;
                                                height: 100%;
                                                max-height: 100px;
                                                max-width: 344px;
                                              "
                                            >
                                              <canvas
                                                id="example-chart-1"
                                                width="370"
                                                height="100"
                                                style="
                                                  width: 100%;
                                                  height: 300px;
                                                "
                                              ></canvas>
                                            </div>
                                          </div>
                                        </div>
                                        <div style="color: rgb(5, 99, 193)">
                                          Hyperlink
                                        </div>
                                        <div style="color: rgb(149, 79, 114)">
                                          Hyperlink
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="theme-picker-footer">
                            <button class="btn btn-reset">
                              <i
                                class="icon-rotate-ccw"
                                style="font-size: 16px"
                              ></i>
                              Reset
                            </button>
                            <div class="footer-actions">
                              <button class="btn btn-cancel">Cancel</button
                              ><button class="btn btn-save save-theme">
                                <i
                                  class="lucide-save"
                                  style="font-size: 16px"
                                ></i>
                                Save Theme
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div
              class="border-0 px-4 pb-4 pt-2 modal-footer d-flex justify-content-between align-items-center"
            >
              <button
                type="button"
                class="btn-cancel btn btn-light"
                data-bs-dismiss="modal"
              >
                Cancel
              </button>
              <button type="button" class="btn btn-primary">
                <i class="icon-save" style="font-size: 24px"></i>
                Save Settings
              </button>
            </div>
          </div>
        </div>
      </div>
      <div
        class="fade settings-modal modal rounded-5"
        id="settingModal"
        data-bs-backdrop="static"
        data-bs-keyboard="false"
        tabindex="-1"
        aria-labelledby="settingModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-xl">
          <div class="modal-content">
            <div class="modal-header">
              <div class="modal-title h4">Edit Slide</div>
              <button
                type="button"
                data-bs-dismiss="modal"
                aria-label="Close"
                class="btn-close"
              ></button>
            </div>
            <div class="p-0 modal-body">
              <div class="d-flex h-100">
                <div class="flex-column settings-sidebar nav nav-pills">
                  <div class="nav-item">
                    <a
                      role="button"
                      class="nav-link active"
                      tabindex="0"
                      href="#"
                      >General</a
                    >
                  </div>
                  <div class="nav-item">
                    <a role="button" class="nav-link" tabindex="0" href="#"
                      >Colors</a
                    >
                  </div>
                  <div class="nav-item">
                    <a role="button" class="nav-link" tabindex="0" href="#"
                      >Fonts</a
                    >
                  </div>
                </div>
                <div class="settings-main flex-grow-1 p-3">
                  <div class="settings-form mt-4" id="general-form">
                    <form class="">
                      <div class="mb-4">
                        <label class="form-label">Slide Size</label
                        ><select class="mb-2 form-select">
                          <option value="standard">Standard (4:3)</option>
                          <option value="widescreen">Widescreen (16:9)</option>
                          <option value="custom">Custom</option>
                        </select>
                        <div class="gap-3 mt-2">
                          <div>
                            <label class="form-label">Width (px)</label
                            ><input
                              min="100"
                              max="3840"
                              class="form-control"
                              type="number"
                              value="1024"
                            />
                          </div>
                          <div>
                            <label class="form-label">Height (px)</label
                            ><input
                              min="100"
                              max="2160"
                              class="form-control"
                              type="number"
                              value="768"
                            />
                          </div>
                        </div>
                      </div>
                      <div class="mb-4">
                        <label class="form-label">Logo</label>
                        <div class="d-flex gap-3 align-items-start">
                          <div class="logo-upload-container">
                            <div
                              class="logo-preview"
                              style="
                                width: 100px;
                                height: 100px;
                                border: 1px dashed rgb(204, 204, 204);
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                margin-bottom: 10px;
                                background-color: rgb(248, 249, 250);
                              "
                            >
                              <span class="text-muted">No logo</span>
                            </div>
                            <input
                              accept="image/*"
                              class="mb-2 form-control"
                              type="file"
                            />
                          </div>
                          <div>
                            <label class="form-label">Logo Position</label
                            ><select class="form-select">
                              <option value="top-left">Top Left</option>
                              <option value="top-center">Top Center</option>
                              <option value="top-right">Top Right</option>
                              <option value="bottom-left">Bottom Left</option>
                              <option value="bottom-center">
                                Bottom Center
                              </option>
                              <option value="bottom-right">Bottom Right</option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </form>
                  </div>
                  <div class="settings-form mt-4" id="colors-form">
                    <div class="theme-color-editor">
                      <div class="mb-4 card">
                        <div class="card-header">
                          <h6 class="mb-0">Slide Colors</h6>
                        </div>
                        <div class="card-body">
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label">Background</label
                              ><small class="text-muted d-block"
                                >Slide background color</small
                              >
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#f0f3f4"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(240, 243, 244);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#f0f3f4"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label">Title Color</label
                              ><small class="text-muted d-block"
                                >Color for slide titles</small
                              >
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#c25b5b"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(194, 91, 91);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#c25b5b"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label"
                                >Content Color</label
                              ><small class="text-muted d-block"
                                >Color for slide content text</small
                              >
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#2c3e50"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(44, 62, 80);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#2c3e50"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="mb-4 card">
                        <div class="card-header">
                          <h6 class="mb-0 d-flex align-items-center">
                            <svg
                              xmlns="http://www.w3.org/2000/svg"
                              width="18"
                              height="18"
                              viewBox="0 0 24 24"
                              fill="none"
                              stroke="currentColor"
                              stroke-width="2"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              class="lucide lucide-palette me-2"
                            >
                              <circle
                                cx="13.5"
                                cy="6.5"
                                r=".5"
                                fill="currentColor"
                              ></circle>
                              <circle
                                cx="17.5"
                                cy="10.5"
                                r=".5"
                                fill="currentColor"
                              ></circle>
                              <circle
                                cx="8.5"
                                cy="7.5"
                                r=".5"
                                fill="currentColor"
                              ></circle>
                              <circle
                                cx="6.5"
                                cy="12.5"
                                r=".5"
                                fill="currentColor"
                              ></circle>
                              <path
                                d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"
                              ></path>
                            </svg>
                            Theme Variants
                          </h6>
                        </div>
                        <div class="card-body">
                          <div class="row">
                            <div class="mb-3 col-md-3 col-6">
                              <div
                                class="theme-variant"
                                style="cursor: pointer"
                              >
                                <div class="theme-variant-preview mb-2">
                                  <div class="d-flex" style="height: 40px">
                                    <div
                                      style="
                                        background-color: rgb(0, 0, 0);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(68, 114, 196);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(237, 125, 49);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(165, 165, 165);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(255, 192, 0);
                                        width: 20%;
                                      "
                                    ></div>
                                  </div>
                                </div>
                                <small class="text-center d-block"
                                  >Office</small
                                >
                              </div>
                            </div>
                            <div class="mb-3 col-md-3 col-6">
                              <div
                                class="theme-variant"
                                style="cursor: pointer"
                              >
                                <div class="theme-variant-preview mb-2">
                                  <div class="d-flex" style="height: 40px">
                                    <div
                                      style="
                                        background-color: rgb(0, 0, 0);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(231, 76, 60);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(243, 156, 18);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(241, 196, 15);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(46, 204, 113);
                                        width: 20%;
                                      "
                                    ></div>
                                  </div>
                                </div>
                                <small class="text-center d-block"
                                  >Colorful</small
                                >
                              </div>
                            </div>
                            <div class="mb-3 col-md-3 col-6">
                              <div
                                class="theme-variant"
                                style="cursor: pointer"
                              >
                                <div class="theme-variant-preview mb-2">
                                  <div class="d-flex" style="height: 40px">
                                    <div
                                      style="
                                        background-color: rgb(31, 78, 121);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(68, 114, 196);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(91, 155, 213);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(165, 165, 165);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(112, 173, 71);
                                        width: 20%;
                                      "
                                    ></div>
                                  </div>
                                </div>
                                <small class="text-center d-block">Blue</small>
                              </div>
                            </div>
                            <div class="mb-3 col-md-3 col-6">
                              <div
                                class="theme-variant"
                                style="cursor: pointer"
                              >
                                <div class="theme-variant-preview mb-2">
                                  <div class="d-flex" style="height: 40px">
                                    <div
                                      style="
                                        background-color: rgb(15, 81, 50);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(112, 173, 71);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(68, 114, 196);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(165, 165, 165);
                                        width: 20%;
                                      "
                                    ></div>
                                    <div
                                      style="
                                        background-color: rgb(255, 192, 0);
                                        width: 20%;
                                      "
                                    ></div>
                                  </div>
                                </div>
                                <small class="text-center d-block">Green</small>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="mb-4 card">
                        <div
                          class="d-flex justify-content-between align-items-center card-header"
                        >
                          <h6 class="mb-0">Text Colors</h6>
                          <button
                            type="button"
                            class="btn btn-outline-secondary btn-sm"
                          >
                            <svg
                              xmlns="http://www.w3.org/2000/svg"
                              width="14"
                              height="14"
                              viewBox="0 0 24 24"
                              fill="none"
                              stroke="currentColor"
                              stroke-width="2"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              class="lucide lucide-rotate-ccw me-1"
                            >
                              <path
                                d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"
                              ></path>
                              <path d="M3 3v5h5"></path>
                            </svg>
                            Reset
                          </button>
                        </div>
                        <div class="card-body">
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label">Dark 1</label
                              ><small class="text-muted d-block"
                                >Primary text</small
                              >
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#c25b5b"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(194, 91, 91);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#c25b5b"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label">Light 1</label
                              ><small class="text-muted d-block"
                                >Background</small
                              >
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#FFFFFF"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(255, 255, 255);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#FFFFFF"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label">Dark 2</label
                              ><small class="text-muted d-block"
                                >Secondary text</small
                              >
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#44546A"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(68, 84, 106);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#44546A"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label">Light 2</label
                              ><small class="text-muted d-block"
                                >Light background</small
                              >
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#E7E6E6"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(231, 230, 230);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#E7E6E6"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="mb-4 card">
                        <div class="card-header">
                          <h6 class="mb-0">Accent Colors</h6>
                        </div>
                        <div class="card-body">
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label">Accent 1</label>
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#4472C4"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(68, 114, 196);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#4472C4"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label">Accent 2</label>
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#ED7D31"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(237, 125, 49);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#ED7D31"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label">Accent 3</label>
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#A5A5A5"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(165, 165, 165);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#A5A5A5"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label">Accent 4</label>
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#FFC000"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(255, 192, 0);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#FFC000"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label">Accent 5</label>
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#5B9BD5"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(91, 155, 213);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#5B9BD5"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label">Accent 6</label>
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#70AD47"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(112, 173, 71);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#70AD47"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="mb-4 card">
                        <div class="card-header">
                          <h6 class="mb-0">Link Colors</h6>
                        </div>
                        <div class="card-body">
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label">Hyperlink</label
                              ><small class="text-muted d-block"
                                >Unvisited links</small
                              >
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#0563C1"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(5, 99, 193);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#0563C1"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                          <div class="mb-3 align-items-center row">
                            <div class="col-4">
                              <label class="mb-0 form-label"
                                >Followed Hyperlink</label
                              ><small class="text-muted d-block"
                                >Visited links</small
                              >
                            </div>
                            <div class="col-3">
                              <div class="d-flex align-items-center gap-2">
                                <input
                                  class="form-control form-control-color"
                                  type="color"
                                  value="#954F72"
                                  style="width: 50px; height: 38px"
                                />
                                <div
                                  class="color-preview"
                                  style="
                                    width: 30px;
                                    height: 30px;
                                    background-color: rgb(149, 79, 114);
                                    border: 1px solid rgb(221, 221, 221);
                                    border-radius: 4px;
                                  "
                                ></div>
                              </div>
                            </div>
                            <div class="col-5">
                              <input
                                class="font-monospace form-control"
                                type="text"
                                value="#954F72"
                                style="font-size: 0.875rem"
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="settings-form mt-4" id="fonts-form">
                    <form class="">
                      <div class="mb-3">
                        <label class="form-label">Title Font</label
                        ><select class="form-select">
                          <option value="Arial">Arial</option>
                          <option value="Helvetica">Helvetica</option>
                          <option value="Times New Roman">
                            Times New Roman
                          </option>
                          <option value="Calibri">Calibri</option>
                          <option value="Georgia">Georgia</option>
                          <option value="Verdana">Verdana</option>
                        </select>
                      </div>
                      <div>
                        <label class="form-label">Body Font</label
                        ><select class="form-select">
                          <option value="Calibri">Calibri</option>
                          <option value="Arial">Arial</option>
                          <option value="Georgia">Georgia</option>
                          <option value="Times New Roman">
                            Times New Roman
                          </option>
                          <option value="Helvetica">Helvetica</option>
                          <option value="Verdana">Verdana</option>
                        </select>
                      </div>
                    </form>
                  </div>
                  <div class="preview-container">
                    <div class="preview-header">
                      <h6 class="preview-title">Preview</h6>
                      <div class="preview-size-info">1024 x 768px</div>
                    </div>
                    <div class="slides-preview-wrapper">
                      <div
                        class="preview-wrapper mb-4"
                        style="
                          width: 800px;
                          height: 600px;
                          overflow: hidden;
                          position: relative;
                          box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;
                          border-radius: 8px;
                          margin: 0px auto;
                          transition: 0.3s;
                        "
                      >
                        <div
                          class="slide-content"
                          style="
                            background-color: rgb(255, 255, 255);
                            transition: background-color 0.3s;
                          "
                        >
                          <div
                            class="editable-title"
                            contenteditable="true"
                            style="
                              color: rgb(0, 0, 0);
                              font-family: Arial;
                              transition: color 0.3s, font-family 0.3s;
                            "
                          >
                            Sales Performance
                          </div>
                          <div
                            class="editable-content"
                            contenteditable="true"
                            style="
                              color: rgb(51, 51, 51);
                              font-family: Calibri;
                              transition: color 0.3s, font-family 0.3s;
                            "
                          >
                            This chart shows quarterly sales performance
                            comparison.
                          </div>
                          <div class="chart-container">
                            <div class="chart-editor preview-mode card mb-3">
                              <div class="card-body">
                                <div
                                  class="d-flex justify-content-between align-items-center mb-3"
                                >
                                  <h5
                                    class="card-title mb-0"
                                    style="
                                      color: rgb(68, 84, 106);
                                      transition: color 0.3s;
                                    "
                                  >
                                    Sales Performance
                                  </h5>
                                </div>
                                <div class="chart-container d-flex flex-column">
                                  <h5
                                    class="text-center mb-3"
                                    style="
                                      color: rgb(68, 84, 106);
                                      transition: color 0.3s;
                                      font-weight: 600;
                                    "
                                  >
                                    Sales Performance
                                  </h5>
                                  <div
                                    style="
                                      width: 100%;
                                      height: 250px;
                                      transition: 0.3s;
                                    "
                                  >
                                    <div
                                      class="recharts-responsive-container"
                                      style="
                                        width: 100%;
                                        height: 100%;
                                        min-width: 0px;
                                      "
                                    >
                                      <div
                                        class="recharts-wrapper d-flex justify-content-center align-items-center"
                                        style="
                                          position: relative;
                                          cursor: default;
                                          width: 100%;
                                          height: 100%;
                                          max-height: 250px;
                                          max-width: 654px;
                                          transition: 0.3s;
                                        "
                                      >
                                        <canvas id="bar-chart-on-edit"></canvas>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div
                        class="preview-wrapper mb-4"
                        style="
                          width: 800px;
                          height: 600px;
                          overflow: hidden;
                          position: relative;
                          box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;
                          border-radius: 8px;
                          margin: 0px auto;
                          transition: 0.3s;
                        "
                      >
                        <div
                          class="slide-content"
                          style="
                            background-color: rgb(255, 255, 255);
                            transition: background-color 0.3s;
                          "
                        >
                          <div
                            class="editable-title"
                            contenteditable="true"
                            style="
                              color: rgb(0, 0, 0);
                              font-family: Arial;
                              transition: color 0.3s, font-family 0.3s;
                            "
                          >
                            Monthly Trends
                          </div>
                          <div
                            class="editable-content"
                            contenteditable="true"
                            style="
                              color: rgb(51, 51, 51);
                              font-family: Calibri;
                              transition: color 0.3s, font-family 0.3s;
                            "
                          >
                            Visualizing the monthly growth trends across
                            different series.
                          </div>
                          <div class="chart-container">
                            <div class="chart-editor preview-mode card mb-3">
                              <div class="card-body">
                                <div
                                  class="d-flex justify-content-between align-items-center mb-3"
                                >
                                  <h5
                                    class="card-title mb-0"
                                    style="
                                      color: rgb(68, 84, 106);
                                      transition: color 0.3s;
                                    "
                                  >
                                    Monthly Trends
                                  </h5>
                                </div>
                                <div class="chart-container d-flex flex-column">
                                  <h5
                                    class="text-center mb-3"
                                    style="
                                      color: rgb(68, 84, 106);
                                      transition: color 0.3s;
                                      font-weight: 600;
                                    "
                                  >
                                    Monthly Stends
                                  </h5>
                                  <div
                                    style="
                                      width: 100%;
                                      height: 250px;
                                      transition: 0.3s;
                                    "
                                  >
                                    <div
                                      class="recharts-responsive-container"
                                      style="
                                        width: 100%;
                                        height: 100%;
                                        min-width: 0px;
                                      "
                                    >
                                      <div
                                        class="recharts-wrapper d-flex justify-content-center align-items-center"
                                        style="
                                          position: relative;
                                          cursor: default;
                                          width: 100%;
                                          height: 100%;
                                          max-height: 250px;
                                          max-width: 654px;
                                          transition: 0.3s;
                                        "
                                      >
                                        <canvas
                                          id="line-chart-on-edit"
                                        ></canvas>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div
                        class="preview-wrapper mb-4"
                        style="
                          width: 800px;
                          height: 600px;
                          overflow: hidden;
                          position: relative;
                          box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;
                          border-radius: 8px;
                          margin: 0px auto;
                          transition: 0.3s;
                        "
                      >
                        <div
                          class="slide-content"
                          style="
                            background-color: rgb(255, 255, 255);
                            transition: background-color 0.3s;
                          "
                        >
                          <div
                            class="editable-title"
                            contenteditable="true"
                            style="
                              color: rgb(0, 0, 0);
                              font-family: Arial;
                              transition: color 0.3s, font-family 0.3s;
                            "
                          >
                            Market Distribution
                          </div>
                          <div
                            class="editable-content"
                            contenteditable="true"
                            style="
                              color: rgb(51, 51, 51);
                              font-family: Calibri;
                              transition: color 0.3s, font-family 0.3s;
                            "
                          >
                            Breakdown of market share across different products.
                          </div>
                          <div class="chart-container">
                            <div class="chart-editor preview-mode card mb-3">
                              <div class="card-body">
                                <div
                                  class="d-flex justify-content-between align-items-center mb-3"
                                >
                                  <h5
                                    class="card-title mb-0"
                                    style="
                                      color: rgb(68, 84, 106);
                                      transition: color 0.3s;
                                    "
                                  >
                                    Market Distribution
                                  </h5>
                                </div>
                                <div class="chart-container d-flex flex-column">
                                  <h5
                                    class="text-center mb-3"
                                    style="
                                      color: rgb(68, 84, 106);
                                      transition: color 0.3s;
                                      font-weight: 600;
                                    "
                                  >
                                    Market Distribution
                                  </h5>
                                  <div
                                    style="
                                      width: 100%;
                                      height: 250px;
                                      transition: 0.3s;
                                    "
                                  >
                                    <div
                                      class="recharts-responsive-container"
                                      style="
                                        width: 100%;
                                        height: 100%;
                                        min-width: 0px;
                                      "
                                    >
                                      <div
                                        class="recharts-wrapper d-flex justify-content-center align-items-center"
                                        style="
                                          position: relative;
                                          cursor: default;
                                          width: 100%;
                                          height: 100%;
                                          max-height: 250px;
                                          max-width: 654px;
                                          transition: 0.3s;
                                        "
                                      >
                                        <canvas id="pie-chart-on-edit"></canvas>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary">Cancel</button
              ><button type="button" class="btn btn-primary">
                Save Settings
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script type="text/typescript">
      document.addEventListener("DOMContentLoaded", function () {

        const saveBtn = document.querySelector<HTMLButtonElement>('.toolbar-btn.success');
  if (saveBtn) {
    saveBtn.addEventListener('click', function () {
      // Gather theme data from DOM
      const slides: any[] = [];
      document.querySelectorAll('.slide-thumbnail').forEach((thumb, idx) => {
        const slideContent = document.querySelectorAll('.slide-content')[idx];
        if (!slideContent) return;

        // Slide background, title, content, fonts
        const background = slideContent.style.backgroundColor || "#ffffff";
        const titleInput = slideContent.querySelector<HTMLInputElement>('.slide-title');
        const bodyTextarea = slideContent.querySelector<HTMLTextAreaElement>('.slide-body');
        const titleColor = titleInput?.style.color || "#000000";
        const contentColor = bodyTextarea?.style.color || "#333333";
        const titleFont = titleInput?.style.fontFamily || "Arial";
        const bodyFont = bodyTextarea?.style.fontFamily || "Calibri";

        // Slide size
        const generalForm = document.getElementById('general-form');
        let slideSize = "standard";
        let customWidth = 1024, customHeight = 768;
        if (generalForm) {
          const select = generalForm.querySelector<HTMLSelectElement>('select.mb-2.form-select');
          const widthInput = generalForm.querySelector<HTMLInputElement>('input[type="number"]:first-child');
          const heightInput = generalForm.querySelector<HTMLInputElement>('input[type="number"]:last-child');
          if (select) slideSize = select.value;
          if (widthInput) customWidth = Number(widthInput.value);
          if (heightInput) customHeight = Number(heightInput.value);
        }

        // Theme colors from colors-form
        const colorsForm = document.getElementById('colors-form');
        let themeColors: any = {};
        if (colorsForm) {
          const colorInputs = colorsForm.querySelectorAll<HTMLInputElement>('input[type="color"]');
          const colorKeys = [
            "background", "titleColor", "contentColor",
            "textDark1", "textLight1", "textDark2", "textLight2",
            "accent1", "accent2", "accent3", "accent4", "accent5", "accent6",
            "hyperlink", "followedHyperlink"
          ];
          colorInputs.forEach((input, i) => {
            if (colorKeys[i]) themeColors[colorKeys[i]] = input.value;
          });
        }

        // Logo image (base64) if exists in .logo-preview
        let logoBase64: string | null = null;
        const logoPreview = document.querySelector('.logo-preview img') as HTMLImageElement | null;
        if (logoPreview && logoPreview.src && logoPreview.src.startsWith('data:image')) {
          logoBase64 = logoPreview.src;
        }

        // Helper to extract chart data
        function extractChartData(chart: any) {
          if (!chart || !chart.data) return {};
          return {
            labels: chart.data.labels || [],
            datasets: (chart.data.datasets || []).map((ds: any) => ({
              label: ds.label,
              data: ds.data,
              backgroundColor: ds.backgroundColor,
              borderColor: ds.borderColor,
              fill: ds.fill,
              type: ds.type
            }))
          };
        }

        // Subslides (charts)
        const subSlides: any[] = [];
        // Bar chart
        subSlides.push({
          id: `slide${idx + 1}-bar`,
          title: titleInput?.value || "Sales Performance",
          content: bodyTextarea?.value || "",
          chart: {
            id: `theme${idx + 1}-bar-chart`,
            type: "bar",
            title: titleInput?.value || "Sales Performance",
            data: extractChartData((window as any).barChart)
          }
        });
        // Line chart
        subSlides.push({
          id: `slide${idx + 1}-line`,
          title: "Monthly Trends",
          content: "Visualizing the monthly growth trends across different series.",
          chart: {
            id: `theme${idx + 1}-line-chart`,
            type: "line",
            title: "Monthly Trends",
            data: extractChartData((window as any).lineChart)
          }
        });
        // Pie chart
        subSlides.push({
          id: `slide${idx + 1}-pie`,
          title: "Market Distribution",
          content: "Breakdown of market share across different products.",
          chart: {
            id: `theme${idx + 1}-pie-chart`,
            type: "pie",
            title: "Market Distribution",
            data: extractChartData((window as any).pieChart)
          }
        });

        slides.push({
          id: idx + 1,
          background,
          titleColor,
          contentColor,
          titleFont,
          bodyFont,
          slideSize,
          customWidth,
          customHeight,
          themeColors,
          logo: logoBase64,
          subSlides
        });
      });

      // Theme summary
      const theme = {
        name: "Default",
        background: slides[0]?.background || "#ffffff",
        titleColor: slides[0]?.titleColor || "#000000",
        contentColor: slides[0]?.contentColor || "#333333",
        colors: slides[0]?.themeColors || {},
        logo: slides[0]?.logo || null
      };

      const json = JSON.stringify({ slides, theme }, null, 2);

      // Download as file
      const blob = new Blob([json], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = "presentation.json";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    });
  }

        // Show settingModal above staticBackdrop when edit-button is clicked
        document.querySelectorAll<HTMLButtonElement>('.edit-button').forEach(btn => {
          btn.addEventListener('click', function (e) {
            e.preventDefault();
            // Show settingModal
            const settingModal = document.getElementById('settingModal');
              // Sync color input changes in #colors-form
              const colorsForm = document.getElementById('colors-form');
              if (colorsForm) {
                // For every color input in colors-form
                colorsForm.querySelectorAll<HTMLInputElement>('input[type="color"]').forEach(colorInput => {
                  colorInput.addEventListener('input', function () {
                    // Set background of next .color-preview
                    const colorPreview = colorInput.parentElement?.querySelector<HTMLElement>('.color-preview');
                    if (colorPreview) {
                      colorPreview.style.backgroundColor = colorInput.value;
                    }
                    // Set value of input[type="text"] in the next sibling div of the parent of parent
                    const parentDiv = colorInput.parentElement?.parentElement;
                    const nextDiv = parentDiv?.nextElementSibling as HTMLElement | null;
                    const textInput = nextDiv?.querySelector<HTMLInputElement>('input[type="text"]');
                    if (textInput) {
                      textInput.value = colorInput.value;
                    }
                  });
                });

                // Sync font-family when selects in fonts-form change
                const fontsForm = document.getElementById('fonts-form');
                if (fontsForm) {
                  const selects = fontsForm.querySelectorAll<HTMLSelectElement>('select.form-select');
                  // 1. Title font
                  if (selects[0]) {
                    selects[0].addEventListener('change', function () {
                      const font = selects[0].value;
                      document.querySelectorAll<HTMLElement>('.editable-title').forEach(el => {
                        el.style.fontFamily = font;
                      });
                      document.querySelectorAll<HTMLInputElement>('.slide-title').forEach(el => {
                        el.style.fontFamily = font;
                      });
                    });
                  }
                  // 2. Body font
                  if (selects[1]) {
                    selects[1].addEventListener('change', function () {
                      const font = selects[1].value;
                      document.querySelectorAll<HTMLElement>('.editable-content').forEach(el => {
                        el.style.fontFamily = font;
                      });
                      document.querySelectorAll<HTMLTextAreaElement>('.slide-body').forEach(el => {
                        el.style.fontFamily = font;
                      });
                    });
                  }
                }

                  // Slide size logic
                  const generalForm = document.getElementById('general-form');
                  const previewSizeInfo = document.querySelector<HTMLElement>('.preview-size-info');
                  const slideContent = document.querySelector<HTMLElement>('.slide-content');
                    console.log('slide-content', slideContent)
                  if (generalForm && previewSizeInfo && slideContent) {
                    const select = generalForm.querySelector<HTMLSelectElement>('select.mb-2.form-select');
                    const customSizeDiv = generalForm.querySelector<HTMLDivElement>('.gap-3.mt-2');
                    if (select && customSizeDiv) {
                      const widthInput = customSizeDiv.querySelectorAll<HTMLInputElement>('input')[0];
                      const heightInput = customSizeDiv.querySelectorAll<HTMLInputElement>('input')[1];

                      // Helper to update slide-content height
                      function updateSlideContentHeight() {
                        const width = Number(widthInput.value);
                        let height = 0;
                        if (select.value === 'standard') {
                          height = Math.round(width / 4 * 3);
                        } else if (select.value === 'widescreen') {
                          height = Math.round(width / 16 * 9);
                        } else if (select.value === 'custom') {
                          const customWidth = Number(widthInput.value);
                          const customHeight = Number(heightInput.value);
                          if (customWidth > 0 && customHeight > 0) {
                            height = Math.round(width / customWidth * customHeight);
                          }
                        }
                        if (height > 0) {
                          slideContent.style.height = `${height}px`;
                        }
                      }

                      // Helper to update preview-size-info text
                      function updatePreviewSizeInfo() {
                        const w = widthInput.value;
                        const h = heightInput.value;
                        previewSizeInfo.textContent = `${w} x ${h}px`;
                      }

                      // On select change
                      select.addEventListener('change', function () {
                        updateSlideContentHeight();
                      });

                      // On width/height input change
                      widthInput.addEventListener('input', function () {
                        updateSlideContentHeight();
                        updatePreviewSizeInfo();
                      });
                      heightInput.addEventListener('input', function () {
                        updateSlideContentHeight();
                        updatePreviewSizeInfo();
                      });

                      // Initial set
                      updateSlideContentHeight();
                      updatePreviewSizeInfo();
                    }
                  }

                    // Get the forth mb-4 card (Accent Colors)
                  const accentColorsCard = colorsForm.querySelectorAll('.mb-4.card')[3];
                  if (accentColorsCard) {
                    const colorInputs = accentColorsCard.querySelectorAll<HTMLInputElement>('input[type="color"]');
                    colorInputs.forEach((colorInput, idx) => {
                      colorInput.addEventListener('input', function () {
                        // Update bar chart colors (exampleChart, exampleChart1, barChart, barChartOnEdit)
                        const colorValue = colorInput.value;

                        // Update exampleChart and exampleChart1 (preview bar charts)
                        if (window.exampleChart && window.exampleChart.data && window.exampleChart.data.datasets[0].backgroundColor) {
                          window.exampleChart.data.datasets[0].backgroundColor[idx] = colorValue;
                          window.exampleChart.update();
                        }
                        if (window.exampleChart1 && window.exampleChart1.data && window.exampleChart1.data.datasets[0].backgroundColor) {
                          window.exampleChart1.data.datasets[0].backgroundColor[idx] = colorValue;
                          window.exampleChart1.update();
                        }

                        // Update pieChart and pieChartOnEdit (preview pie charts)
                        if (window.pieChart && window.pieChart.data && window.pieChart.data.datasets[0].backgroundColor) {
                          window.pieChart.data.datasets[0].backgroundColor[idx] = colorValue;
                          window.pieChart.update();
                        }
                        if (window.pieChartOnEdit && window.pieChartOnEdit.data && window.pieChartOnEdit.data.datasets[0].backgroundColor) {
                          window.pieChartOnEdit.data.datasets[0].backgroundColor[idx] = colorValue;
                          window.pieChartOnEdit.update();
                        }

                        // Update barChart and barChartOnEdit (main bar charts, if you want to sync them)
                        if (window.barChart && window.barChart.data && window.barChart.data.datasets[0].backgroundColor) {
                          window.barChart.data.datasets[0].backgroundColor[idx] = colorValue;
                          window.barChart.update();
                        }
                        if (window.barChartOnEdit && window.barChartOnEdit.data && window.barChartOnEdit.data.datasets[0].backgroundColor) {
                          window.barChartOnEdit.data.datasets[0].backgroundColor[idx] = colorValue;
                          window.barChartOnEdit.update();
                        }

                        // Update lineChart and lineChartOnEdit (lines color)
                        if (window.lineChart && window.lineChart.data && window.lineChart.data.datasets[idx]) {
                          window.lineChart.data.datasets[idx].borderColor = colorValue;
                          window.lineChart.update();
                        }
                        if (window.lineChartOnEdit && window.lineChartOnEdit.data && window.lineChartOnEdit.data.datasets[idx]) {
                          window.lineChartOnEdit.data.datasets[idx].borderColor = colorValue;
                          window.lineChartOnEdit.update();
                        }
                      });
                    });
                  }
              }

              if (colorsForm) {
              // Get the first mb-4 card (Slide Colors)
              const slideColorsCard = colorsForm.querySelector('.mb-4.card');
              if (slideColorsCard) {
                const colorInputs = slideColorsCard.querySelectorAll<HTMLInputElement>('input[type="color"]');
                // 1. Background color (first input)
                if (colorInputs[0]) {
                  colorInputs[0].addEventListener('input', function () {
                    document.querySelectorAll<HTMLElement>('.slide-content').forEach(sc => {
                      sc.style.backgroundColor = colorInputs[0].value;
                    });
                    const activeThumb = document.querySelector('.slide-thumbnail.active .thumbnail-preview') as HTMLElement | null;
                    if (activeThumb) {
                      activeThumb.style.backgroundColor = colorInputs[0].value;
                    }
                  });
                }
                // 2. Title color (second input)
                if (colorInputs[1]) {
                  colorInputs[1].addEventListener('input', function () {
                    document.querySelectorAll<HTMLElement>('.editable-title').forEach(title => {
                      title.style.color = colorInputs[1].value;
                    });
                    document.querySelectorAll<HTMLElement>('.slide-title').forEach(title => {
                      title.style.color = colorInputs[1].value;
                    });
                    const activeTitle = document.querySelector('.slide-thumbnail.active .thumbnail-title') as HTMLElement | null;
                    if (activeTitle) {
                      activeTitle.style.color = colorInputs[1].value;
                    }
                  });
                }
                // 3. Content color (third input)
                if (colorInputs[2]) {
                  colorInputs[2].addEventListener('input', function () {
                    document.querySelectorAll<HTMLElement>('.editable-content').forEach(content => {
                      content.style.color = colorInputs[2].value;
                    });
                    document.querySelectorAll<HTMLElement>('.slide-body').forEach(title => {
                      title.style.color = colorInputs[1].value;
                    });
                    const activeContent = document.querySelector('.slide-thumbnail.active .thumbnail-text') as HTMLElement | null;
                    if (activeContent) {
                      activeContent.style.color = colorInputs[2].value;
                    }
                  });
                }
              }
            }

              // Save Settings button in settingModal: close settingModal and show staticBackdrop
              const settingModal = document.getElementById('settingModal');
              const staticBackdrop = document.getElementById('staticBackdrop');
              if (settingModal && staticBackdrop) {
                const saveBtn = settingModal.querySelector<HTMLButtonElement>('.modal-footer .btn.btn-primary');
                if (saveBtn) {
                  saveBtn.addEventListener('click', function () {
                    // Use Bootstrap's modal API if available
                    // @ts-ignore
                    if (window.bootstrap && window.bootstrap.Modal) {
                      // Hide settingModal
                      // @ts-ignore
                      const bsModal = window.bootstrap.Modal.getOrCreateInstance(settingModal);
                      bsModal.hide();

                      // Show staticBackdrop
                      // @ts-ignore
                      const staticBackdropModal = window.bootstrap.Modal.getOrCreateInstance(staticBackdrop);
                      staticBackdropModal && staticBackdropModal.show();
                    } else {
                      // Fallback: manual show/hide
                      settingModal.style.display = 'none';
                      settingModal.classList.remove('show');
                      settingModal.setAttribute('aria-hidden', 'true');
                      staticBackdrop.style.display = 'block';
                      staticBackdrop.classList.add('show');
                      staticBackdrop.removeAttribute('aria-hidden');
                    }
                  });
                }
              }


              const logoInput = document.querySelector<HTMLInputElement>('input[type="file"]');
              const logoPreview = document.querySelector<HTMLElement>('.logo-preview');
              const logoPositionSelect = logoInput?.closest('.d-flex')?.parentElement?.querySelector('select.form-select');
              const previewWrappers = document.querySelectorAll<HTMLElement>('.preview-wrapper');
              const slideContents = document.querySelectorAll<HTMLElement>('.slide-content.mb-4');

              // Helper to update logo position class for all logo images in preview
              function updateLogoPositionClass(position: string) {
                previewWrappers.forEach(wrapper => {
                  const logoDiv = wrapper.querySelector('.logo-container');
                  if (logoDiv) {
                    logoDiv.className = `logo-container logo-${position}`;
                  }
                });
                slideContents.forEach(content => {
                  const logoDiv = content.querySelector('.logo-container');
                  if (logoDiv) {
                    logoDiv.className = `logo-container logo-${position}`;
                  }
                });
              }

              if (logoInput && logoPreview && logoPositionSelect && previewWrappers.length > 0 && slideContents.length > 0) {
                logoInput.addEventListener('change', function () {
                  const file = logoInput.files && logoInput.files[0];
                  if (!file) return;

                  const reader = new FileReader();
                  reader.onload = function (event) {
                    const base64 = event.target?.result as string;
                    // Show image in logo-preview
                    logoPreview.innerHTML = `<img src="${base64}" alt="Logo" style="max-width:100%;max-height:100%;">`;

                    // Remove any existing logo-container in all preview-wrappers
                    previewWrappers.forEach(wrapper => {
                      const oldLogo = wrapper.querySelector('.logo-container');
                      if (oldLogo) oldLogo.remove();

                      // Get logo position (default to top-left if not found)
                      const posValue = logoPositionSelect.value || 'top-left';
                      const logoDiv = document.createElement('div');
                      logoDiv.className = `logo-container logo-${posValue}`;
                      logoDiv.style.position = 'absolute';
                      // You can add more position logic here if needed
                      logoDiv.innerHTML = `<img src="${base64}" alt="Logo" style="max-width:80px;max-height:80px;">`;
                      wrapper.prepend(logoDiv);
                    });
                    // Remove any existing logo-container in all slide-contents
                    slideContents.forEach(wrapper => {
                      const oldLogo = wrapper.querySelector('.logo-container');
                      if (oldLogo) oldLogo.remove();

                      // Get logo position (default to top-left if not found)
                      const posValue = logoPositionSelect.value || 'top-left';
                      const logoDiv = document.createElement('div');
                      logoDiv.className = `logo-container logo-${posValue}`;
                      logoDiv.style.position = 'absolute';
                      // You can add more position logic here if needed
                      logoDiv.innerHTML = `<img src="${base64}" alt="Logo" style="max-width:80px;max-height:80px;">`;
                      wrapper.prepend(logoDiv);
                    });
                  };
                  reader.readAsDataURL(file);
                });

                // When logo position select changes, update class for all logo images in preview
                logoPositionSelect.addEventListener('change', function () {
                  const posValue = logoPositionSelect.value || 'top-left';
                  updateLogoPositionClass(posValue);
                });
              }

            if (settingModal) {
              // Use Bootstrap's modal API if available
              // @ts-ignore
              if (window.bootstrap && window.bootstrap.Modal) {
                // Hide staticBackdrop but keep it in DOM
                // @ts-ignore
                const staticBackdropModal = window.bootstrap.Modal.getOrCreateInstance(document.getElementById('staticBackdrop'));
                staticBackdropModal && staticBackdropModal.hide();

                // Show settingModal
                // @ts-ignore
                const bsModal = window.bootstrap.Modal.getOrCreateInstance(settingModal);
                bsModal.show();
              } else {
                // Fallback: manual show/hide
                settingModal.style.display = 'block';
                settingModal.classList.add('show');
                settingModal.removeAttribute('aria-hidden');
              }
            }
          });
        });

        
        const settingModal = document.getElementById('settingModal');
        const staticBackdrop = document.getElementById('staticBackdrop');
            // Store initial values for both settingModal and staticBackdrop
        let initialSettingModalState: {
          colorInputs: string[],
          textInputs: string[],
          selectInputs: string[],
          fontSelects: string[],
          slideContentStyles: {bg: string, title: string, content: string, titleFont: string, contentFont: string}[],
          logoPreview: string,
          logoContainers: string[],
          logoPosition: string,
          // StaticBackdrop state
          staticSlideContents: {bg: string, title: string, content: string, titleFont: string, contentFont: string}[],
          staticThumbPreviewBg: string,
          staticThumbTitleColor: string,
          staticThumbContentColor: string
        } | null = null;

        function saveInitialSettingModalState() {
          if (!settingModal || !staticBackdrop) return;
          // SettingModal state
          const colorInputs = Array.from(settingModal.querySelectorAll<HTMLInputElement>('input[type="color"]')).map(i => i.value);
          const textInputs = Array.from(settingModal.querySelectorAll<HTMLInputElement>('input[type="text"]')).map(i => i.value);
          const selectInputs = Array.from(settingModal.querySelectorAll<HTMLSelectElement>('select')).map(s => s.value);
          const fontsForm = settingModal.querySelector('#fonts-form');
          const fontSelects = fontsForm ? Array.from(fontsForm.querySelectorAll<HTMLSelectElement>('select')).map(s => s.value) : [];
          const slideContents = Array.from(settingModal.querySelectorAll<HTMLElement>('.slide-content'));
          const slideContentStyles = slideContents.map(sc => ({
            bg: sc.style.backgroundColor,
            title: (sc.querySelector('.editable-title') as HTMLElement)?.style.color || '',
            content: (sc.querySelector('.editable-content') as HTMLElement)?.style.color || '',
            titleFont: (sc.querySelector('.editable-title') as HTMLElement)?.style.fontFamily || '',
            contentFont: (sc.querySelector('.editable-content') as HTMLElement)?.style.fontFamily || ''
          }));
          const logoPreview = settingModal.querySelector('.logo-preview')?.innerHTML || '';
          const logoContainers = Array.from(settingModal.querySelectorAll('.preview-wrapper .logo-container')).map(div => div.outerHTML);
          const logoPosition = settingModal.querySelector('select.form-select')?.value || 'top-left';

          // StaticBackdrop state
          // Save all .slide-content in staticBackdrop
          const staticSlideContents = Array.from(staticBackdrop.querySelectorAll<HTMLElement>('.slide-content')).map(sc => ({
            bg: sc.style.backgroundColor,
            title: (sc.querySelector('.slide-title') as HTMLElement)?.style.color || '',
            content: (sc.querySelector('.slide-body') as HTMLElement)?.style.color || '',
            titleFont: (sc.querySelector('.slide-title') as HTMLElement)?.style.fontFamily || '',
            contentFont: (sc.querySelector('.slide-body') as HTMLElement)?.style.fontFamily || ''
          }));
          // Save active thumbnail preview and text colors
          const staticThumbPreview = staticBackdrop.querySelector<HTMLElement>('.slide-thumbnail.active .thumbnail-preview');
          const staticThumbTitle = staticBackdrop.querySelector<HTMLElement>('.slide-thumbnail.active .thumbnail-title');
          const staticThumbContent = staticBackdrop.querySelector<HTMLElement>('.slide-thumbnail.active .thumbnail-text');
          const staticThumbPreviewBg = staticThumbPreview ? staticThumbPreview.style.backgroundColor : '';
          const staticThumbTitleColor = staticThumbTitle ? staticThumbTitle.style.color : '';
          const staticThumbContentColor = staticThumbContent ? staticThumbContent.style.color : '';

          initialSettingModalState = {
            colorInputs,
            textInputs,
            selectInputs,
            fontSelects,
            slideContentStyles,
            logoPreview,
            logoContainers,
            logoPosition,
            staticSlideContents,
            staticThumbPreviewBg,
            staticThumbTitleColor,
            staticThumbContentColor
          };
        }

        // Save initial state when opening settingModal
        document.querySelectorAll<HTMLButtonElement>('.edit-button').forEach(btn => {
          btn.addEventListener('click', function () {
            saveInitialSettingModalState();
          });
        });

        // Restore all values and styles when Cancel is clicked
        if (settingModal && staticBackdrop) {
          const cancelBtn = settingModal.querySelector<HTMLButtonElement>('.btn.btn-secondary');
          if (cancelBtn) {
            cancelBtn.addEventListener('click', function () {
              if (!initialSettingModalState) return;
              // Restore settingModal values (as before)
              const colorInputs = settingModal.querySelectorAll<HTMLInputElement>('input[type="color"]');
              const textInputs = settingModal.querySelectorAll<HTMLInputElement>('input[type="text"]');
              colorInputs.forEach((input, idx) => { input.value = initialSettingModalState!.colorInputs[idx]; input.dispatchEvent(new Event('input')); });
              textInputs.forEach((input, idx) => { input.value = initialSettingModalState!.textInputs[idx]; });

              const selectInputs = settingModal.querySelectorAll<HTMLSelectElement>('select');
              selectInputs.forEach((select, idx) => { select.value = initialSettingModalState!.selectInputs[idx]; select.dispatchEvent(new Event('change')); });

              const fontsForm = settingModal.querySelector('#fonts-form');
              if (fontsForm) {
                const fontSelects = fontsForm.querySelectorAll<HTMLSelectElement>('select');
                fontSelects.forEach((select, idx) => { select.value = initialSettingModalState!.fontSelects[idx]; select.dispatchEvent(new Event('change')); });
              }

              const slideContents = settingModal.querySelectorAll<HTMLElement>('.slide-content');
              slideContents.forEach((sc, idx) => {
                const state = initialSettingModalState!.slideContentStyles[idx];
                sc.style.backgroundColor = state.bg;
                const title = sc.querySelector('.editable-title') as HTMLElement | null;
                if (title) {
                  title.style.color = state.title;
                  title.style.fontFamily = state.titleFont;
                }
                const content = sc.querySelector('.editable-content') as HTMLElement | null;
                if (content) {
                  content.style.color = state.content;
                  content.style.fontFamily = state.contentFont;
                }
              });

              const logoPreview = settingModal.querySelector('.logo-preview');
              if (logoPreview) logoPreview.innerHTML = initialSettingModalState!.logoPreview;

              settingModal.querySelectorAll('.preview-wrapper .logo-container').forEach(div => div.remove());
              const previewWrappers = settingModal.querySelectorAll('.preview-wrapper');
              initialSettingModalState!.logoContainers.forEach((html, idx) => {
                if (previewWrappers[idx]) {
                  previewWrappers[idx].insertAdjacentHTML('afterbegin', html);
                }
              });

              const logoPositionSelect = settingModal.querySelector('select.form-select');
              if (logoPositionSelect) {
                logoPositionSelect.value = initialSettingModalState!.logoPosition;
                logoPositionSelect.dispatchEvent(new Event('change'));
              }

              // --- Restore staticBackdrop Modal values/styles ---
              // Restore all .slide-content styles in staticBackdrop
              const staticSlideContents = staticBackdrop.querySelectorAll<HTMLElement>('.slide-content');
              staticSlideContents.forEach((sc, idx) => {
                const state = initialSettingModalState!.staticSlideContents[idx];
                sc.style.backgroundColor = state.bg;
                const title = sc.querySelector('.slide-title') as HTMLElement | null;
                if (title) {
                  title.style.color = state.title;
                  title.style.fontFamily = state.titleFont;
                }
                const content = sc.querySelector('.slide-body') as HTMLElement | null;
                if (content) {
                  content.style.color = state.content;
                  content.style.fontFamily = state.contentFont;
                }
                // Remove any logo-container in staticBackdrop slide-content
                const logoDiv = sc.querySelector('.logo-container');
                if (logoDiv) logoDiv.remove();
              });
              // Restore active thumbnail preview and text colors
              const staticThumbPreview = staticBackdrop.querySelector<HTMLElement>('.slide-thumbnail.active .thumbnail-preview');
              const staticThumbTitle = staticBackdrop.querySelector<HTMLElement>('.slide-thumbnail.active .thumbnail-title');
              const staticThumbContent = staticBackdrop.querySelector<HTMLElement>('.slide-thumbnail.active .thumbnail-text');
              if (staticThumbPreview) staticThumbPreview.style.backgroundColor = initialSettingModalState!.staticThumbPreviewBg;
              if (staticThumbTitle) staticThumbTitle.style.color = initialSettingModalState!.staticThumbTitleColor;
              if (staticThumbContent) staticThumbContent.style.color = initialSettingModalState!.staticThumbContentColor;
            });
          }
        }

        
        // When close button in settingModal is clicked, hide settingModal and show staticBackdrop
        const settingModal = document.getElementById('settingModal');
        if (settingModal) {
          const cancelBtn = settingModal.querySelector<HTMLButtonElement>('.btn.btn-secondary');
          if (cancelBtn) {
            cancelBtn.addEventListener('click', function () {
              // Use Bootstrap's modal API if available
              // @ts-ignore
              if (window.bootstrap && window.bootstrap.Modal) {
                // Hide settingModal
                // @ts-ignore
                const bsModal = window.bootstrap.Modal.getOrCreateInstance(settingModal);
                bsModal.hide();

                // Show staticBackdrop
                // @ts-ignore
                const staticBackdropModal = window.bootstrap.Modal.getOrCreateInstance(document.getElementById('staticBackdrop'));
                staticBackdropModal && staticBackdropModal.show();
              } else {
                // Fallback: manual show/hide
                settingModal.style.display = 'none';
                settingModal.classList.remove('show');
                settingModal.setAttribute('aria-hidden', 'true');
                // Show staticBackdrop
                const staticBackdrop = document.getElementById('staticBackdrop');
                if (staticBackdrop) {
                  staticBackdrop.style.display = 'block';
                  staticBackdrop.classList.add('show');
                  staticBackdrop.removeAttribute('aria-hidden');
                }
              }
            });
          }
          const closeBtn = settingModal.querySelector<HTMLButtonElement>('.btn-close');
          if (closeBtn) {
            closeBtn.addEventListener('click', function () {
              // Use Bootstrap's modal API if available
              // @ts-ignore
              if (window.bootstrap && window.bootstrap.Modal) {
                // Hide settingModal
                // @ts-ignore
                const bsModal = window.bootstrap.Modal.getOrCreateInstance(settingModal);
                bsModal.hide();

                // Show staticBackdrop
                // @ts-ignore
                const staticBackdropModal = window.bootstrap.Modal.getOrCreateInstance(document.getElementById('staticBackdrop'));
                staticBackdropModal && staticBackdropModal.show();
              } else {
                // Fallback: manual show/hide
                settingModal.style.display = 'none';
                settingModal.classList.remove('show');
                settingModal.setAttribute('aria-hidden', 'true');
                // Show staticBackdrop
                const staticBackdrop = document.getElementById('staticBackdrop');
                if (staticBackdrop) {
                  staticBackdrop.style.display = 'block';
                  staticBackdrop.classList.add('show');
                  staticBackdrop.removeAttribute('aria-hidden');
                }
              }
            });
          }
        }

        function handleThemeBtnClick(this: HTMLButtonElement) {
          // Remove active from all
          document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
          // Add active to clicked
          this.classList.add('active');

          // Get background color from theme button
          const bgColor = this.style.backgroundColor;

          // Get theme-title and theme-content colors from inside the button
          const themeTitleDiv = this.querySelector('.theme-title') as HTMLElement | null;
          const themeContentDiv = this.querySelector('.theme-content') as HTMLElement | null;
          const themeTitleColor = themeTitleDiv ? themeTitleDiv.style.color : '';
          const themeContentColor = themeContentDiv ? themeContentDiv.style.color : '';

          // Set color-picker input and span
          const colorPickerInput = document.querySelector<HTMLInputElement>(".color-picker input[type='color']");
          const colorPickerSpan = document.querySelector<HTMLSpanElement>(".color-picker span");
          if (colorPickerInput && colorPickerSpan) {
            function rgbToHex(rgb: string) {
              if (!rgb) return '#ffffff';
              if (rgb.startsWith('#')) return rgb;
              const result = rgb.match(/\d+/g);
              if (!result) return '#ffffff';
              return (
                '#' +
                result
                  .slice(0, 3)
                  .map(x => ('0' + parseInt(x).toString(16)).slice(-2))
                  .join('')
              );
            }
            colorPickerInput.value = rgbToHex(bgColor);
            colorPickerSpan.textContent = rgbToHex(bgColor).toUpperCase();
          }

          // Set background color of all .slide-content
          document.querySelectorAll<HTMLElement>('.slide-content').forEach(sc => {
            sc.style.backgroundColor = bgColor;
          });

          // Set color of all .slide-title
          document.querySelectorAll<HTMLInputElement>('.slide-title').forEach(st => {
            if (themeTitleColor) st.style.color = themeTitleColor;
          });

          // Set color of all .slide-body
          document.querySelectorAll<HTMLTextAreaElement>('.slide-body').forEach(sb => {
            if (themeContentColor) sb.style.color = themeContentColor;
          });

            // Set background color of .new-slide-thumbnail and first .slide-thumbnail
          const newSlide = document.querySelector<HTMLElement>('.new-slide-thumbnail .thumbnail-preview');
            console.log("newslide", newslide)
          if (newSlide) {
            newSlide.style.backgroundColor = bgColor;
          }
          const firstSlide = document.querySelector<HTMLElement>('.slide-thumbnail .thumbnail-preview');
          if (firstSlide) {
            firstSlide[0].style.backgroundColor = bgColor;
          }
        }



        // Pagination functionality for slides
        function updatePagination() {
          const slideThumbnails = document.querySelectorAll('.slide-thumbnail');
          const pagination = document.querySelector('.slide-counter');
          // Find the active slide index (1-based)
          let activeIndex = 1;
          slideThumbnails.forEach((thumb, idx) => {
            if (thumb.classList.contains('active')) {
              activeIndex = idx + 1;
            }
          });
          if (pagination) pagination.textContent = `${activeIndex} / ${slideThumbnails.length}`;

          // Enable/disable prev/next buttons
          const prevBtn = document.querySelector<HTMLButtonElement>('.toolbar-section .toolbar-btn:nth-child(1)');
          const nextBtn = document.querySelector<HTMLButtonElement>('.toolbar-section .toolbar-btn:nth-child(3)');
          if (prevBtn) prevBtn.disabled = activeIndex === 1;
          if (nextBtn) nextBtn.disabled = activeIndex === slideThumbnails.length;
        }

        // Set active slide and update pagination on click
        function setSlideClickHandlers() {
          const slideThumbnails = document.querySelectorAll('.slide-thumbnail');
          slideThumbnails.forEach((thumb, idx) => {
            thumb.addEventListener('click', function () {
              slideThumbnails.forEach(t => t.classList.remove('active'));
              thumb.classList.add('active');
              updatePagination();
            });
          });
        }

        // Initial setup
        updatePagination();
        setSlideClickHandlers();

        // Show the corresponding .settings-form when clicking sidebar nav items
        const sidebarNav = document.querySelector('.settings-sidebar.nav.nav-pills');
        const settingsForms = document.querySelectorAll<HTMLElement>('.settings-form');

        if (sidebarNav && settingsForms.length > 0) {
          const navItems = sidebarNav.querySelectorAll<HTMLElement>('.nav-item');
          navItems.forEach((item, idx) => {
            item.addEventListener('click', function () {
              // Remove active from all nav-links
              navItems.forEach(i => {
                const link = i.querySelector('.nav-link');
                if (link) link.classList.remove('active');
              });
              // Add active to clicked nav-link
              const link = item.querySelector('.nav-link');
              if (link) link.classList.add('active');

              // Show only the corresponding settings-form, hide others
              settingsForms.forEach((form, i) => {
                form.style.display = (i === idx) ? 'block' : 'none';
              });
            });
          });
          // On load, show only the first settings-form
          settingsForms.forEach((form, i) => {
            form.style.display = (i === 0) ? 'block' : 'none';
          });
        }


        // Show/hide custom size inputs in general-form based on select value
        const generalForm = document.getElementById('general-form');
        if (generalForm) {
          const select = generalForm.querySelector<HTMLSelectElement>('select.form-select');
            const customSizeDiv = generalForm.querySelector<HTMLDivElement>('.gap-3.mt-2');
              if (select && customSizeDiv) {
                // Initial state
                customSizeDiv.style.display = select.value === 'custom' ? 'flex' : 'none';
                select.addEventListener('change', function () {
              console.log('select-------------->', customSizeDiv)
              customSizeDiv.style.display = select.value === 'custom' ? 'flex' : 'none';
            });
          }
        }


        // Toolbar navigation for slides
        const prevBtn = document.querySelector<HTMLButtonElement>('.toolbar-section .toolbar-btn:nth-child(1)');
        const nextBtn = document.querySelector<HTMLButtonElement>('.toolbar-section .toolbar-btn:nth-child(3)');

        function moveSlide(direction: 'prev' | 'next') {
          const slideThumbnails = Array.from(document.querySelectorAll<HTMLDivElement>('.slide-thumbnail'));
          const currentIdx = slideThumbnails.findIndex(t => t.classList.contains('active'));
          if (currentIdx === -1) return;

          let newIdx = currentIdx;
          if (direction === 'prev' && currentIdx > 0) newIdx = currentIdx - 1;
          if (direction === 'next' && currentIdx < slideThumbnails.length - 1) newIdx = currentIdx + 1;

          if (newIdx !== currentIdx) {
            slideThumbnails.forEach(t => t.classList.remove('active'));
            slideThumbnails[newIdx].classList.add('active');
            updatePagination();
          }
        }

        if (prevBtn) {
          prevBtn.addEventListener('click', function () {
            moveSlide('prev');
          });
        }
        if (nextBtn) {
          nextBtn.addEventListener('click', function () {
            moveSlide('next');
          });
        }


        // Sync font-info text and preview-text font-family when selects change in fonts-editor-body
        document.querySelectorAll<HTMLSelectElement>('.fonts-editor-body select').forEach(select => {
          select.addEventListener('change', function () {
            // Find the closest .font-group
            const fontGroup = select.closest('.font-group');
            if (!fontGroup) return;

            // Update font-info text
            const fontInfoName = fontGroup.querySelector<HTMLElement>('.font-info .font-name');
            if (fontInfoName) fontInfoName.textContent = select.value;

            // Update preview-text font-family
            const previewText = fontGroup.querySelector<HTMLElement>('.preview-text');
            if (previewText) previewText.style.fontFamily = select.value;
          });
        });


        const saveFontsBtn = document.querySelector<HTMLButtonElement>('.btn-save.save-fonts');
        const fontsEditorOverlay = document.querySelector<HTMLElement>('.fonts-editor-overlay');
        const fontsEditorBody = document.querySelector<HTMLElement>('.fonts-editor-body');
        const dropdownMenu = document.querySelector<HTMLElement>('.dropdown-menu.show.position-absolute');

        if (saveFontsBtn && fontsEditorOverlay && fontsEditorBody && dropdownMenu) {
          saveFontsBtn.addEventListener('click', function (e) {
            e.preventDefault();

            // Get theme name from input in fonts-editor-body
            const themeNameInput = fontsEditorBody.querySelector<HTMLInputElement>('input[type="text"]');
            const themeName = themeNameInput ? themeNameInput.value.trim() : 'Custom Fonts';

            // Get all select values as font names
            const selectValues = Array.from(fontsEditorBody.querySelectorAll<HTMLSelectElement>('select'))
              .map(sel => sel.value)
              .join(' / ');

            // Create new dropdown item
            const item = document.createElement('button');
            item.className = 'dropdown-item d-flex align-items-center gap-2 select-font';
            item.type = 'button';
            item.innerHTML = `
              <i class="icon-type" style="font-size: 16px"></i><br>
              <span><strong>${themeName}</strong> &mdash; ${selectValues}</span>
            `;

            dropdownMenu.prepend(item);

            // Handle click on font theme dropdown items to apply fonts to slides
            document.querySelectorAll<HTMLButtonElement>('.dropdown-item.d-flex.align-items-center.gap-2.select-font').forEach(item => {
              item.addEventListener('click', function () {
                // Get the text content inside the span, e.g. "ThemeName — Font1 / Font2"
                const span = item.querySelector('span');
                if (!span) return;
                // Extract font names from the text (after the em dash)
                const match = span.textContent?.split('—');
                if (!match || match.length < 2) return;
                const fonts = match[1].trim().split(' / ');
                const titleFont = fonts[0]?.trim() || 'Arial';
                const bodyFont = fonts[1]?.trim() || 'Calibri';
                console.log(`Applying fonts: Title - ${titleFont}, Body - ${bodyFont}`);

                // Set font-family of input and textarea in all .slide-content
                document.querySelectorAll<HTMLElement>('.slide-content').forEach(sc => {
                  const input = sc.querySelector<HTMLInputElement>('input.slide-title');
                  const textarea = sc.querySelector<HTMLTextAreaElement>('textarea.slide-body');
                  if (input) input.style.fontFamily = titleFont;
                  if (textarea) textarea.style.fontFamily = bodyFont;

                      // Close the dropdown menu
                const dropdownMenu = item.closest('.dropdown-menu');
                if (dropdownMenu) {
                  (dropdownMenu as HTMLElement).style.display = 'none';
                }
                });
              });
            });


            // Close the fonts-editor-overlay modal
            fontsEditorOverlay.style.display = 'none';
          });
        }


        const colorPickerInput = document.querySelector<HTMLInputElement>('.color-picker input[type="color"]');
        if (colorPickerInput) {
          colorPickerInput.addEventListener('input', function () {
            const nextSpan = colorPickerInput.nextElementSibling as HTMLSpanElement | null;
            if (nextSpan) {
              nextSpan.textContent = colorPickerInput.value.toUpperCase();
              // Set background color of all .slide-content
              document.querySelectorAll<HTMLElement>('.slide-content').forEach(sc => {
                sc.style.backgroundColor = colorPickerInput.value;
              });
              const activeThumbnail = document.querySelectorAll<HTMLElement>('.slide-thumbnail.active > .thumbnail-preview');
                console.log("==========>", activeThumbnail)
              if (activeThumbnail) activeThumbnail[0].style.backgroundColor = colorPickerInput.value;
            }
          });
        }


        // When adding a new slide, update pagination and handlers
        const newSlideBtn = document.querySelector<HTMLDivElement>(".new-slide-thumbnail");
        const slidesSidebar = document.querySelector<HTMLElement>(".slides-sidebar");
        let num = document.querySelectorAll('.slide-thumbnail').length + 1;
        if (newSlideBtn && slidesSidebar) {
          newSlideBtn.addEventListener("click", function () {
            // Create new slide-thumbnail div
            const slide = document.createElement("div");

              slide.className = "slide-thumbnail";
              slide.innerHTML = `
                <div class="thumbnail-preview" style="background-color: #fff; cursor: pointer;">
                  <div class="thumbnail-content" data-editing="false" style="color: #000;">
                    <div class="thumbnail-title">Sales Performance</div>
                    <div class="thumbnail-text" style="color: #333;">This chart shows quarterly sales pe...</div>
                  </div>
                </div>
                <div class="thumbnail-footer">
                  <div class="thumbnail-number">Theme ${num}</div>
                  <button class="edit-button" data-bs-toggle="modal" data-bs-target="#settingModal">
                    <i class="icon-pen" style="font-size: 16px"></i>
                  </button>
                </div>
              `;
              num++;
              slidesSidebar.appendChild(slide);
            // Remove active from all, set new as active
            document.querySelectorAll('.slide-thumbnail').forEach(t => t.classList.remove('active'));
            slide.classList.add('active');

            updatePagination();
            setSlideClickHandlers();
          });
        }

        const toggleBtn = document.getElementById("toggleSettingsBtn") as HTMLButtonElement | null;
        const panel = document.getElementById("settingsPanel") as HTMLElement | null;
        if (toggleBtn && panel) {
          toggleBtn.addEventListener("click", function () {
            panel.style.display =
              panel.style.display === "none" || panel.style.display === ""
                ? "block"
                : "none";
            if (panel.style.display === "block") {
              // @ts-ignore
              if (window.barChart) window.barChart.resize();
              // @ts-ignore
              if (window.lineChart) window.lineChart.resize();
              // @ts-ignore
              if (window.pieChart) window.pieChart.resize();
              // Add more if you have more charts
            }
          });
        }
        // Theme picker overlay toggle
        const themeBtn = document.getElementById("themePickerBtn") as HTMLButtonElement | null;
        const overlay = document.getElementById("themePickerOverlay") as HTMLElement | null;
        if (themeBtn && overlay) {
          themeBtn.addEventListener("click", function () {
            overlay.style.display =
              overlay.style.display === "none" || overlay.style.display === ""
                ? "block"
                : "none";
          });
        }

        // Optional: close overlay when clicking the close button inside overlay
        const closeBtn = document.querySelector<HTMLButtonElement>("#themePickerOverlay .close-button");
        if (closeBtn && overlay) {
          closeBtn.addEventListener("click", function () {
            overlay.style.display = "none";
          });
        }


        // Section tabs toggle logic
        document.querySelectorAll<HTMLButtonElement>('.section-tab').forEach((tab, idx, tabs) => {
          tab.addEventListener('click', function () {
            // Remove active from all tabs
            tabs.forEach(t => t.classList.remove('active'));
            // Add active to clicked tab
            tab.classList.add('active');

            // Show only the corresponding .color-inputs, hide others
            const colorInputs = document.querySelectorAll<HTMLElement>('.color-inputs');
            colorInputs.forEach((ci, i) => {
              ci.style.display = (i === idx) ? 'block' : 'none';
            });
          });
        });

        // On load, show only the first .color-inputs, hide others
        document.addEventListener('DOMContentLoaded', function () {
          const colorInputs = document.querySelectorAll<HTMLElement>('.color-inputs');
          colorInputs.forEach((ci, i) => {
            ci.style.display = (i === 0) ? 'block' : 'none';
          });
        });

        // Theme button click: set active, update color-picker
        const themeButtons = document.querySelectorAll<HTMLButtonElement>(".theme-btn");
        const colorPickerInput = document.querySelector<HTMLInputElement>(".color-picker input[type='color']");
        const colorPickerSpan = document.querySelector<HTMLSpanElement>(".color-picker span");

        themeButtons.forEach(btn => {
          btn.addEventListener('click', function () {
            // Remove active from all
            themeButtons.forEach(b => b.classList.remove('active'));
            // Add active to clicked
            btn.classList.add('active');

            // Get background color from theme button
            const bgColor = btn.style.backgroundColor;

            // Get theme-title and theme-content colors from inside the button
            const themeTitleDiv = btn.querySelector('.theme-title') as HTMLElement | null;
            const themeContentDiv = btn.querySelector('.theme-content') as HTMLElement | null;
            const themeTitleColor = themeTitleDiv ? themeTitleDiv.style.color : '';
            const themeContentColor = themeContentDiv ? themeContentDiv.style.color : '';

            // Set color-picker input and span
            if (colorPickerInput && colorPickerSpan) {
              function rgbToHex(rgb: string) {
                if (!rgb) return '#ffffff';
                if (rgb.startsWith('#')) return rgb;
                const result = rgb.match(/\d+/g);
                if (!result) return '#ffffff';
                return (
                  '#' +
                  result
                    .slice(0, 3)
                    .map(x => ('0' + parseInt(x).toString(16)).slice(-2))
                    .join('')
                );
              }
              colorPickerInput.value = rgbToHex(bgColor);
              colorPickerSpan.textContent = rgbToHex(bgColor).toUpperCase();
            }

            const newSlide = document.querySelector<HTMLElement>('.new-slide-thumbnail .thumbnail-preview');
            if (newSlide) {
              newSlide.style.backgroundColor = bgColor;
              const newContentIcon = newSlide.querySelector('.new-slide-content > i') as HTMLElement | null;
              const newContentSpan = newSlide.querySelector('.new-slide-content > span') as HTMLElement | null;
              if (newContentIcon) newContentIcon.style.color = themeContentColor;
              if (newContentSpan) newContentSpan.style.color = themeContentColor;
            }
            const firstSlide = document.querySelector<HTMLElement>('.slide-thumbnail.active .thumbnail-preview');

            if (firstSlide) {
              firstSlide.style.backgroundColor = bgColor;
              const firstSlideTitle = firstSlide.querySelector('.thumbnail-content .thumbnail-title') as HTMLElement | null;
              const firstSlideContent = firstSlide.querySelector('.thumbnail-content .thumbnail-text') as HTMLElement | null;
              firstSlideTitle.style.color = themeTitleColor;
              firstSlideContent.style.color = themeContentColor;
            }

            // Set background color of all .slide-content
            document.querySelectorAll<HTMLElement>('.slide-content').forEach(sc => {
              sc.style.backgroundColor = bgColor;
            });

            // Set color of all .slide-title
            document.querySelectorAll<HTMLInputElement>('.slide-title').forEach(st => {
              if (themeTitleColor) st.style.color = themeTitleColor;
            });

            // Set color of all .slide-body
            document.querySelectorAll<HTMLTextAreaElement>('.slide-body').forEach(sb => {
              if (themeContentColor) sb.style.color = themeContentColor;
            });
          });
        });


        // Sync color input and preview bar colors for account-colors
        const accountColorsDiv = document.getElementById('account-colors');
        if (accountColorsDiv) {
          const colorInputs = accountColorsDiv.querySelectorAll<HTMLInputElement>('input[type="color"]');
          const textInputs = accountColorsDiv.querySelectorAll<HTMLInputElement>('input[type="text"]');

          colorInputs.forEach((colorInput, idx) => {
            colorInput.addEventListener('input', function () {
              // Update the corresponding text input value
              if (textInputs[idx]) textInputs[idx].value = colorInput.value;

              // Update the bar color in both preview charts
              // @ts-ignore
              if (window.exampleChart) {
                // @ts-ignore
                window.exampleChart.data.datasets[0].backgroundColor[idx] = colorInput.value;
                // @ts-ignore
                window.exampleChart.update();
              }
              // @ts-ignore
              if (window.exampleChart1) {
                // @ts-ignore
                window.exampleChart1.data.datasets[0].backgroundColor[idx] = colorInput.value;
                // @ts-ignore
                window.exampleChart1.update();
              }
            });
          });
        }


        const saveThemeBtn = document.querySelector<HTMLButtonElement>('.btn-save.save-theme');
        const themeGrid = document.querySelector<HTMLElement>('.theme-grid');
        const textColorsDiv = document.getElementById('text-colors');
        const themePickerOverlay = document.getElementById('themePickerOverlay');
        const themeNameInput = document.querySelector<HTMLInputElement>('.theme-name-input input');

        if (saveThemeBtn && themeGrid && textColorsDiv && themePickerOverlay && themeNameInput) {
          saveThemeBtn.addEventListener('click', function () {
            // Get color values from text-colors inputs
            const colorInputs = textColorsDiv.querySelectorAll<HTMLInputElement>('input[type="color"]');
            if (colorInputs.length < 2) return; // Need at least two colors

            const titleColor = colorInputs[0].value; // First color input
            const bgColor = colorInputs[1].value;    // Second color input
            const themeName = themeNameInput.value || "Custom"; // Get theme name input

            // Create new theme button
            const btn = document.createElement('button');
            btn.className = 'theme-btn';
            btn.style.backgroundColor = bgColor;
            btn.style.color = titleColor;
            btn.innerHTML = `
              <div class="theme-preview">
                <div class="theme-title" style="color: ${titleColor}">${themeName}</div>
                <div class="theme-content" style="color: #333">Sample Text</div>
              </div>
            `;

            // Add click event to behave like other theme buttons
            btn.addEventListener('click', function () {
              document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
              btn.classList.add('active');
              // You can add the same logic as your other theme-btn click here if needed
            });

            // For new buttons (when creating)
            btn.addEventListener('click', handleThemeBtnClick);
            themeGrid.appendChild(btn);

            // Close the theme-picker-overlay modal
            themePickerOverlay.style.display = "none";
          });
        }

        // Close themePickerOverlay when btn-cancel is clicked inside it
        const themePickerOverlay = document.getElementById('themePickerOverlay');
        if (themePickerOverlay) {
          const cancelBtn = themePickerOverlay.querySelector<HTMLButtonElement>('.btn-cancel');
          if (cancelBtn) {
            cancelBtn.addEventListener('click', function () {
              themePickerOverlay.style.display = 'none';
            });
          }
        }

        // Sync color input and preview link colors for links-colors
        const linksColorsDiv = document.getElementById('links-colors');
        if (linksColorsDiv) {
          const colorInputs = linksColorsDiv.querySelectorAll<HTMLInputElement>('input[type="color"]');
          const textInputs = linksColorsDiv.querySelectorAll<HTMLInputElement>('input[type="text"]');
          // Get all .preview-item > div (the main preview blocks)
          const previewBlocks = document.querySelectorAll<HTMLElement>('.preview-item > div');

          colorInputs.forEach((colorInput, idx) => {
            colorInput.addEventListener('input', function () {
              // Update the corresponding text input value
              if (textInputs[idx]) textInputs[idx].value = colorInput.value;

              // For each preview block, update the color of the 3rd and 4th divs (Hyperlink and Followed Hyperlink)
              previewBlocks.forEach(block => {
                const innerDivs = block.querySelectorAll<HTMLElement>('div');
                  console.log("inter-div -------->"innerDivs,)
                // 3rd div (index 2) and 4th div (index 3) are the link color targets
                if (innerDivs[3 + idx]) {
                  innerDivs[4 + idx].style.color = colorInput.value;
                }
              });
            });
          });
        }


        // Store initial values of all color and text inputs in .color-inputs
        const colorInputsGroups = document.querySelectorAll<HTMLElement>('.color-inputs');
        const initialInputValues: {color: string[], text: string[]}[] = [];

        colorInputsGroups.forEach(group => {
          const colorInputs = Array.from(group.querySelectorAll<HTMLInputElement>('input[type="color"]')).map(input => input.value);
          const textInputs = Array.from(group.querySelectorAll<HTMLInputElement>('input[type="text"]')).map(input => input.value);
          initialInputValues.push({ color: colorInputs, text: textInputs });
        });

        // Reset button logic
        const resetBtn = document.querySelector<HTMLButtonElement>('.btn-reset');
        if (resetBtn) {
          resetBtn.addEventListener('click', function () {
            colorInputsGroups.forEach((group, groupIdx) => {
              const colorInputs = group.querySelectorAll<HTMLInputElement>('input[type="color"]');
              const textInputs = group.querySelectorAll<HTMLInputElement>('input[type="text"]');
              // Restore initial values
              colorInputs.forEach((input, idx) => {
                input.value = initialInputValues[groupIdx].color[idx];
                input.dispatchEvent(new Event('input')); // Trigger input event to update preview
              });
              textInputs.forEach((input, idx) => {
                input.value = initialInputValues[groupIdx].text[idx];
              });
            });
          });
        }


        // Toggle dropdown menu on hover for the theme fonts button
        const fontsDropdownBtn = document.querySelector<HTMLButtonElement>('.btn.btn-primary.d-flex.align-items-center.gap-1');
        const dropdownMenu = document.querySelector<HTMLElement>('.dropdown-menu.show.position-absolute');

        if (fontsDropdownBtn && dropdownMenu) {
          let dropdownTimeout: number | undefined;

          // Show dropdown on button hover
          fontsDropdownBtn.addEventListener('mouseenter', () => {
            if (dropdownTimeout) clearTimeout(dropdownTimeout);
            dropdownMenu.style.display = 'block';
          });

          // Hide dropdown when mouse leaves button (but wait in case mouse enters menu)
          fontsDropdownBtn.addEventListener('mouseleave', () => {
            dropdownTimeout = window.setTimeout(() => {
              if (!dropdownMenu.matches(':hover')) {
                dropdownMenu.style.display = 'none';
              }
            }, 150);
          });

          // Keep dropdown open when mouse is over the menu
          dropdownMenu.addEventListener('mouseenter', () => {
            if (dropdownTimeout) clearTimeout(dropdownTimeout);
            dropdownMenu.style.display = 'block';
          });

          // Hide dropdown when mouse leaves the menu
          dropdownMenu.addEventListener('mouseleave', () => {
            dropdownTimeout = window.setTimeout(() => {
              dropdownMenu.style.display = 'none';
            }, 150);
          });
        }

        // Sync color input and preview background for text-colors
        const textColorsDiv = document.getElementById('text-colors');
        if (textColorsDiv) {
          const colorInputs = textColorsDiv.querySelectorAll<HTMLInputElement>('input[type="color"]');
          const textInputs = textColorsDiv.querySelectorAll<HTMLInputElement>('input[type="text"]');
          const previewItems = document.querySelectorAll<HTMLElement>('.preview-item>div');

          colorInputs.forEach((colorInput, idx) => {
            colorInput.addEventListener('input', function () {
              // Update the corresponding text input value
              if (textInputs[idx]) textInputs[idx].value = colorInput.value;

              // Update the background color of the corresponding preview item
              if (previewItems[idx]) {
                previewItems[idx].style.backgroundColor = colorInput.value;
                if (idx === 0) {
                  // Update text color for the first preview item
                  previewItems[idx + 1].style.color = colorInput.value;
                }
                if (idx === 1) {
                  previewItems[idx - 1].style.color = colorInput.value;
                }
              }
            });
          });
        }


        // Show fonts-editor-overlay modal when dropdown-fonts-edit-overlay is clicked
        const fontsEditBtn = document.getElementById('dropdown-fonts-edit-overlay');
        const fontsEditorOverlay = document.querySelector<HTMLElement>('.fonts-editor-overlay');

        if (fontsEditBtn && fontsEditorOverlay) {
          fontsEditBtn.addEventListener('click', function () {
            fontsEditorOverlay.style.display = 'block';
          });
        }

        // Optional: close the overlay when clicking the close button inside it
        const fontsEditorCloseBtn = document.querySelector<HTMLButtonElement>('.fonts-editor-overlay .close-button');
        if (fontsEditorCloseBtn && fontsEditorOverlay) {
          fontsEditorCloseBtn.addEventListener('click', function () {
            fontsEditorOverlay.style.display = 'none';
          });
        }

        function customTooltip(tooltip) {
          let tooltipEl = document.getElementById('chartjs-tooltip');
          if (!tooltipEl) {
            tooltipEl = document.createElement('div');
            tooltipEl.id = 'chartjs-tooltip';
            tooltipEl.className = 'chartjs-tooltip hidden';
            document.body.appendChild(tooltipEl);
          }

          // Hide if no tooltip
          if (tooltip.opacity === 0) {
            tooltipEl.classList.add('hidden');
            return;
          }

          // Set caret Position
          tooltipEl.classList.remove('hidden');

          if (tooltip.body) {
            const titleLines = tooltip.title || [];
            const bodyLines = tooltip.body.map(b => b.lines);

            let innerHtml = '<div>';
            titleLines.forEach(title => {
              innerHtml += `<div style="font-weight:bold;margin-bottom:4px;">${title}</div>`;
            });
            bodyLines.forEach((body, i) => {
              const color = tooltip.labelColors[i].backgroundColor;
              innerHtml += `<div style="margin-bottom:2px;">
                <span style="display:inline-block;width:10px;height:10px;background:${color};border-radius:2px;margin-right:8px;vertical-align:middle;"></span>
                ${body}
              </div>`;
            });
            innerHtml += '</div>';
            tooltipEl.innerHTML = innerHtml;
          }

          const position = this._chart.canvas.getBoundingClientRect();
          tooltipEl.style.left = position.left + window.pageXOffset + tooltip.caretX + 'px';
          tooltipEl.style.top = position.top + window.pageYOffset + tooltip.caretY + 'px';
        }

        var xValues = ["Q1", "Q2", "Q3", "Q4"];
        var yValues1 = [65, 45, 75, 55]; // First bar values
        var yValues2 = [45, 55, 35, 65]; // Second bar values
        var barColors1 = "rgb(68, 114, 196)";
        var barColors2 = "rgb(237, 125, 49)";
        window.barChart = new Chart("bar-chart", {
          type: "bar",
          data: {
            labels: xValues,
            datasets: [
              {
                label: "Series 1",
                backgroundColor: barColors1,
                data: yValues1
              },
              {
                label: "Series 2",
                backgroundColor: barColors2,
                data: yValues2
              }
            ]
          },
          options: {
            legend: { display: true },
            responsive: true,
            maintainAspectRatio: false,
            title: {
              display: true,
              text: "Sales Performance"
            },
            tooltips: {
              enabled: true,
              callbacks: {
                title: function(tooltipItems, data) {
                  // Show the label (e.g., Q1)
                  return data.labels[tooltipItems[0].index];
                },
                label: function(tooltipItem, data) {
                  // Show both series values for the hovered label
                  const idx = tooltipItem.index;
                  const s1 = data.datasets[0].data[idx];
                  const s2 = data.datasets[1].data[idx];
                  return [
                    'Series 1: ' + s1,
                    'Series 2: ' + s2
                  ];
                }
              }
            },
            scales: {
              yAxes: [{
                ticks: {
                  min: 0,
                  max: 80
                }
              }]
            }
          }
        });

        window.barChartOnEdit = new Chart("bar-chart-on-edit", {
          type: "bar",
          data: {
            labels: xValues,
            datasets: [
              {
                label: "Series 1",
                backgroundColor: barColors1,
                data: yValues1
              },
              {
                label: "Series 2",
                backgroundColor: barColors2,
                data: yValues2
              }
            ]
          },
          options: {
            legend: { display: true },
            responsive: true,
            maintainAspectRatio: false,
            title: {
              display: true,
              text: "Sales Performance"
            },
            tooltips: {
              enabled: true,
              callbacks: {
                title: function(tooltipItems, data) {
                  // Show the label (e.g., Q1)
                  return data.labels[tooltipItems[0].index];
                },
                label: function(tooltipItem, data) {
                  // Show both series values for the hovered label
                  const idx = tooltipItem.index;
                  const s1 = data.datasets[0].data[idx];
                  const s2 = data.datasets[1].data[idx];
                  return [
                    'Series 1: ' + s1,
                    'Series 2: ' + s2
                  ];
                }
              }
            },
            scales: {
              yAxes: [{
                ticks: {
                  min: 0,
                  max: 80
                }
              }]
            }
          }
        });

        const xValuesForLine = ["Jan", "Feb", "Mar", "Apr", "May"];

        window.lineChart = new Chart("line-chart", {
          type: "line",
          data: {
            labels: xValuesForLine,
            datasets: [{
              label: "Series 1",
              data: [40, 45, 55, 60, 75],
              borderColor: barColors1,
              fill: false
            },{
              label: "Series 2",
              data: [30, 50, 45, 65, 70],
              borderColor: barColors2,
              fill: false
            }]
          },

          options: {
            legend: { display: true },
            responsive: true,
            maintainAspectRatio: false,
            title: {
              display: true,
              text: "Monthly trends"
            },
              tooltips: {
                enabled: true,
                callbacks: {
                  title: function(tooltipItems, data) {
                    // Show the label (e.g., Q1)
                    return data.labels[tooltipItems[0].index];
                  },
                  label: function(tooltipItem, data) {
                    // Show both series values for the hovered label
                    const idx = tooltipItem.index;
                    const s1 = data.datasets[0].data[idx];
                    const s2 = data.datasets[1].data[idx];
                    return [
                      'Series 1: ' + s1,
                      'Series 2: ' + s2
                    ];
                  }
                }
              },
            scales: {
              yAxes: [{
                ticks: {
                  min: 0,
                  max: 80,
                  stepSize: 20 // 0, 20, 40, 60, 80 (4 steps)
                }
              }]
            }
          }
        });


        window.lineChartOnEdit = new Chart("line-chart-on-edit", {
          type: "line",
          data: {
            labels: xValuesForLine,
            datasets: [{
              label: "Series 1",
              data: [40, 45, 55, 60, 75],
              borderColor: barColors1,
              fill: false
            },{
              label: "Series 2",
              data: [30, 50, 45, 65, 70],
              borderColor: barColors2,
              fill: false
            }]
          },

          options: {
            legend: { display: true },
            responsive: true,
            maintainAspectRatio: false,
            title: {
              display: true,
              text: "Monthly trends"
            },
              tooltips: {
                enabled: true,
                callbacks: {
                  title: function(tooltipItems, data) {
                    // Show the label (e.g., Q1)
                    return data.labels[tooltipItems[0].index];
                  },
                  label: function(tooltipItem, data) {
                    // Show both series values for the hovered label
                    const idx = tooltipItem.index;
                    const s1 = data.datasets[0].data[idx];
                    const s2 = data.datasets[1].data[idx];
                    return [
                      'Series 1: ' + s1,
                      'Series 2: ' + s2
                    ];
                  }
                }
              },
            scales: {
              yAxes: [{
                ticks: {
                  min: 0,
                  max: 80,
                  stepSize: 20 // 0, 20, 40, 60, 80 (4 steps)
                }
              }]
            }
          }
        });

        var xValuesForPie = ["Product A", "Product B", "Product C", "Product D", "Product E"];
          var yValuesForPie = [35, 25, 20, 15, 5];
          var barColorsForPie = [
            "rgb(68, 114, 196)",
            "rgb(237, 125, 49)",
            "rgb(165, 165, 165)",
            "rgb(255, 192, 0)",
            "rgb(91, 155, 213)"
          ];

          window.pieChart = new Chart("pie-chart", {
            type: "pie",
            data: {
              labels: xValuesForPie,
              datasets: [{
                backgroundColor: barColorsForPie,
                data: yValuesForPie
              }]
            },
            tooltips: {
              enabled: false, // Disable the default tooltip
              custom: customTooltip,
              mode: 'index',
              intersect: false,
              animation: {
                duration: 200
              }
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              title: {
                display: true,
                text: "Market Distribution"
              }
            }
          });


          window.pieChartOnEdit = new Chart("pie-chart-on-edit", {
            type: "pie",
            data: {
              labels: xValuesForPie,
              datasets: [{
                backgroundColor: barColorsForPie,
                data: yValuesForPie
              }]
            },
            tooltips: {
              enabled: false, // Disable the default tooltip
              custom: customTooltip,
              mode: 'index',
              intersect: false,
              animation: {
                duration: 200
              }
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              title: {
                display: true,
                text: "Market Distribution"
              }
            }
          });

          var yValuesForExample = [10, 20, 30, 25, 15, 5];

          var barColorsForExample = ["#4472C4", "#ED7D31","#A5A5A5","#FFC000","#5B9BD5", "#70AD47"];

          window.exampleChart = new Chart("example-chart", {
            type: "bar",
            data: {
              labels: ["A", "B", "C", "D", "E", "F"],
            datasets: [{
              backgroundColor: barColorsForExample,
              data: yValuesForExample
            }]
          },
          options: {
            legend: { display: false },
            responsive: true,
            maintainAspectRatio: false,
            tooltips: { enabled: false },   // disable tooltip
            scales: {
              xAxes: [{
                display: false,            // Hide x-axis
                gridLines: { display: false }
              }],
              yAxes: [{
                display: false,            // Hide y-axis
                gridLines: { display: false }
              }]
            }
          }
        });
        window.exampleChart1 = new Chart("example-chart-1", {
          type: "bar",
          data: {
            labels: ["A", "B", "C", "D", "E", "F"],
            datasets: [{
              backgroundColor: barColorsForExample,
              data: yValuesForExample
            }]
          },
          options: {
            legend: { display: false },
            responsive: true,
            maintainAspectRatio: false,
            tooltips: { enabled: false },   // disable tooltip
            scales: {
              xAxes: [{
                display: false,            // Hide x-axis
                gridLines: { display: false }
              }],
              yAxes: [{
                display: false,            // Hide y-axis
                gridLines: { display: false }
              }]
            }
          }
        });

      });
    </script>
    <script>
      // Transpile TypeScript to JavaScript
      const tsCode = document.querySelector(
        'script[type="text/typescript"]'
      ).textContent;
      const jsCode = ts.transpileModule(tsCode, {
        compilerOptions: { module: ts.ModuleKind.CommonJS },
      });
      eval(jsCode.outputText);
    </script>
  </body>
</html>
